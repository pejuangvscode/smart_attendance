<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/MainActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/MainActivity.kt" />
              <option name="originalContent" value="package com.example.smartattendance&#10;&#10;import android.app.Activity&#10;import android.graphics.Bitmap&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.animation.AnimatedVisibility&#10;import androidx.compose.animation.ExperimentalAnimationApi&#10;import androidx.compose.animation.core.FastOutSlowInEasing&#10;import androidx.compose.animation.core.tween&#10;import androidx.compose.animation.fadeIn&#10;import androidx.compose.animation.fadeOut&#10;import androidx.compose.animation.slideInHorizontally&#10;import androidx.compose.animation.slideInVertically&#10;import androidx.compose.animation.slideOutHorizontally&#10;import androidx.compose.animation.slideOutVertically&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Surface&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.SideEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.core.view.WindowCompat&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.screens.AttendanceDetailScreen&#10;import com.example.smartattendance.ui.screens.AttendanceScreen&#10;import com.example.smartattendance.ui.screens.CameraScreen&#10;import com.example.smartattendance.ui.screens.HistoryScreen&#10;import com.example.smartattendance.ui.screens.HomeScreen&#10;import com.example.smartattendance.ui.screens.ListScreen&#10;import com.example.smartattendance.ui.screens.LoginScreen&#10;import com.example.smartattendance.ui.screens.RequestPermissionScreen&#10;import com.example.smartattendance.ui.screens.ScheduleScreen&#10;import com.example.smartattendance.ui.screens.SignUpScreen&#10;import com.example.smartattendance.ui.screens.SubmissionCompleteScreen&#10;import com.example.smartattendance.ui.screens.SubmitAttendanceScreen&#10;import com.example.smartattendance.ui.screens.CreatePermissionFormScreen&#10;import com.example.smartattendance.ui.theme.SmartAttendanceTheme&#10;import com.example.smartattendance.utils.SessionManager&#10;import androidx.navigation.NavType&#10;import androidx.navigation.navArgument&#10;import com.example.smartattendance.ui.screens.SubmissionScreen&#10;import com.example.smartattendance.ui.screens.SubmitionComplete&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        // This enables edge-to-edge display and makes the status bar transparent.&#10;        enableEdgeToEdge()&#10;&#10;        setContent {&#10;            SmartAttendanceTheme {&#10;                Surface(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    color = Color.White&#10;                ) {&#10;                    AppNavigation()&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@OptIn(ExperimentalMaterial3Api::class, ExperimentalAnimationApi::class)&#10;@Composable&#10;fun AppNavigation() {&#10;    val navController = rememberNavController()&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentRoute = navBackStackEntry?.destination?.route ?: &quot;login&quot;&#10;    // Initialize SessionManager&#10;    val context = LocalView.current.context&#10;    val sessionManager = remember { SessionManager(context) }&#10;&#10;    // State for captured photo and attendance detail parameters&#10;    var capturedPhoto by remember { mutableStateOf&lt;Bitmap?&gt;(null) }&#10;    var isLateAttendance by remember { mutableStateOf(false) }&#10;    var selectedClassName by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedStatus by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedCourseCode by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedLecturerId by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedRoom by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedDay by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedStartTime by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedEndTime by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedAttendanceDate by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedRecordedAt by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // State to hold the current user&#10;    var user by remember { mutableStateOf&lt;AuthApi.User?&gt;(null) }&#10;&#10;    // Check session on app start&#10;    var startDestination by remember { mutableStateOf(&quot;login&quot;) }&#10;    LaunchedEffect(Unit) {&#10;        sessionManager.userFlow.collect { savedUser -&gt;&#10;            if (savedUser != null) {&#10;                user = savedUser&#10;                startDestination = &quot;home&quot;&#10;            } else {&#10;                startDestination = &quot;login&quot;&#10;            }&#10;        }&#10;    }&#10;&#10;&#10;    // --- Dynamic Status Bar Color ---&#10;    val view = LocalView.current&#10;    // This effect runs whenever the currentRoute changes.&#10;    // It adjusts the status bar icon color based on the screen's background.&#10;    if (!view.isInEditMode) {&#10;        SideEffect {&#10;            val window = (view.context as Activity).window&#10;            // When on 'home' screen (dark header), icons are light (false).&#10;            // On other screens (light background), icons are dark (true).&#10;            WindowCompat.getInsetsController(window, view).isAppearanceLightStatusBars = currentRoute != &quot;home&quot;&#10;        }&#10;    }&#10;    // --- End of Status Bar Logic ---&#10;&#10;    // Routes where bottom navigation should be shown&#10;    val routesWithBottomNav = setOf(&quot;home&quot;, &quot;attendance&quot;, &quot;history&quot;, &quot;schedule&quot;, &quot;request_permission&quot;, &quot;create_permission_request&quot;, &quot;submission_complete&quot;, &quot;pending_request&quot;)&#10;&#10;    Scaffold(&#10;        bottomBar = {&#10;            AnimatedVisibility(&#10;                visible = currentRoute in routesWithBottomNav,&#10;                enter = slideInVertically(&#10;                    initialOffsetY = { it },&#10;                    animationSpec = tween(300, easing = FastOutSlowInEasing)&#10;                ) + fadeIn(animationSpec = tween(300)),&#10;                exit = slideOutVertically(&#10;                    targetOffsetY = { it },&#10;                    animationSpec = tween(300, easing = FastOutSlowInEasing)&#10;                ) + fadeOut(animationSpec = tween(300))&#10;            ) {&#10;                AppBottomNavigation(&#10;                    currentRoute = currentRoute,&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        }&#10;    ) { paddingValues -&gt;&#10;        NavHost(&#10;            navController = navController,&#10;            startDestination = startDestination,&#10;            modifier = Modifier.padding(paddingValues),&#10;            enterTransition = { slideInHorizontally(initialOffsetX = { it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeIn(animationSpec = tween(300)) },&#10;            exitTransition = { slideOutHorizontally(targetOffsetX = { -it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeOut(animationSpec = tween(300)) },&#10;            popEnterTransition = { slideInHorizontally(initialOffsetX = { -it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeIn(animationSpec = tween(300)) },&#10;            popExitTransition = { slideOutHorizontally(targetOffsetX = { it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeOut(animationSpec = tween(300)) }&#10;        ) {&#10;            composable(&#10;                &quot;login&quot;,&#10;                enterTransition = { fadeIn(animationSpec = tween(500)) },&#10;                exitTransition = { fadeOut(animationSpec = tween(300)) }&#10;            ) {&#10;                LoginScreen(&#10;                    sessionManager = sessionManager,&#10;                    onLoginSuccess = { loggedInUser -&gt;&#10;                        user = loggedInUser&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;login&quot;) { inclusive = true }&#10;                        }&#10;                    },&#10;                    onSignUpClick = {&#10;                        navController.navigate(&quot;sign_up&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;sign_up&quot;&#10;            ){&#10;                SignUpScreen(&#10;                    onNavigateToLogin ={&#10;                        navController.navigate(&quot;login&quot;){&#10;                            popUpTo(0)&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;home&quot;) {&#10;                HomeScreen(&#10;                    user = user,&#10;                    sessionManager = sessionManager,&#10;                    navController = navController,&#10;                    onLogout = {&#10;                        user = null // Clear user on logout&#10;                        navController.navigate(&quot;login&quot;) {&#10;                            popUpTo(0)&#10;                        }&#10;                    },&#10;                    onDateClick = {&#10;                        navController.navigate(&quot;history&quot;)&#10;                    },&#10;                    onRequestPermission = {&#10;                        navController.navigate(&quot;request_permission&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;attendance&quot;) {&#10;                AttendanceScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onTakePhoto = {&#10;                        navController.navigate(&quot;camera&quot;)&#10;                    },&#10;                    onAskPermission = {&#10;                        navController.navigate(&quot;request_permission&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;camera&quot;) {&#10;                CameraScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onPhotoTaken = { bitmap -&gt;&#10;                        capturedPhoto = bitmap&#10;                        isLateAttendance = false&#10;                        navController.navigate(&quot;submit_attendance&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;submit_attendance&quot;) {&#10;                SubmitAttendanceScreen(&#10;                    capturedPhoto = capturedPhoto,&#10;                    isLateAttendance = isLateAttendance,&#10;                    onBackClick = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    },&#10;                    onTakePhotoClick = {&#10;                        navController.navigate(&quot;camera&quot;)&#10;                    },&#10;                    onSubmitSuccess = {&#10;                        capturedPhoto = null&#10;                        isLateAttendance = false&#10;                        navController.navigate(&quot;submission_complete&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = false }&#10;                            launchSingleTop = true&#10;                        }&#10;                    },&#10;                    onNavigateHome = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;history&quot;) {&#10;                HistoryScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigateToDetail = { className, status, courseCode, lecturerId, room, day, startTime, endTime, attendanceDate, recordedAt -&gt;&#10;                        selectedClassName = className&#10;                        selectedStatus = status&#10;                        selectedCourseCode = courseCode&#10;                        selectedLecturerId = lecturerId&#10;                        selectedRoom = room&#10;                        selectedDay = day&#10;                        selectedStartTime = startTime&#10;                        selectedEndTime = endTime&#10;                        selectedAttendanceDate = attendanceDate&#10;                        selectedRecordedAt = recordedAt&#10;                        navController.navigate(&quot;attendance_detail&quot;)&#10;                    },&#10;                    onNavigateToSchedule = {&#10;                        navController.navigate(&quot;schedule&quot;) {&#10;                            popUpTo(&quot;home&quot;) { saveState = true }&#10;                            launchSingleTop = true&#10;                            restoreState = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;attendance_detail&quot;) {&#10;                AttendanceDetailScreen(&#10;                    className = selectedClassName,&#10;                    status = selectedStatus,&#10;                    courseCode = selectedCourseCode,&#10;                    lecturerId = selectedLecturerId,&#10;                    room = selectedRoom,&#10;                    day = selectedDay,&#10;                    startTime = selectedStartTime,&#10;                    endTime = selectedEndTime,&#10;                    attendanceDate = selectedAttendanceDate,&#10;                    recordedAt = selectedRecordedAt,&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    }&#10;                )&#10;            }&#10;&#10;            // List screen for center navigation&#10;            composable(&quot;list&quot;) {&#10;                ListScreen(&#10;                    onNavigateBack = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    },&#10;                    onCardClick = { className, status -&gt;&#10;                        selectedClassName = className&#10;                        selectedStatus = status&#10;                        navController.navigate(&quot;attendance_detail&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;schedule&quot;) {&#10;                ScheduleScreen(&#10;                    user = user,&#10;                    onNavigateBack = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;submission_complete&quot;) {&#10;                SubmissionCompleteScreen(&#10;                    status = selectedStatus, // pass the selected status&#10;                    courseName = selectedClassName, // pass the selected class name&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigateHome = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;request_permission&quot;) {&#10;                RequestPermissionScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onCreateRequest = {&#10;                        // TODO: Navigate to create permission request screen&#10;                        navController.navigate(&quot;create_permission_form&quot;)&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;create_permission_form&quot;) {&#10;                CreatePermissionFormScreen(&#10;                    user = user,&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onSubmit = {&#10;                        navController.popBackStack()&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;submission_screen/{scheduleId}/{courseId}&quot;,&#10;                arguments = listOf(&#10;                    navArgument(&quot;scheduleId&quot;) { type = androidx.navigation.NavType.IntType },&#10;                    navArgument(&quot;courseId&quot;) { type = androidx.navigation.NavType.IntType }&#10;                )&#10;            ) { backStackEntry -&gt;&#10;                val scheduleId = backStackEntry.arguments?.getInt(&quot;scheduleId&quot;)&#10;                val courseId = backStackEntry.arguments?.getInt(&quot;courseId&quot;)&#10;                SubmissionScreen(&#10;                    user = user,&#10;                    navController = navController,&#10;                    scheduleId = scheduleId,&#10;                    courseId = courseId&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;submission_complete_screen/{status}/{courseName}/{courseId}/{scheduleId}&quot;,&#10;                arguments = listOf(&#10;                    navArgument(&quot;status&quot;) { type = NavType.StringType },&#10;                    navArgument(&quot;courseName&quot;) { type = NavType.StringType },&#10;                    navArgument(&quot;courseId&quot;) { type = NavType.IntType },&#10;                    navArgument(&quot;scheduleId&quot;) { type = NavType.IntType }&#10;                )&#10;            ) { backStackEntry -&gt;&#10;                val status = backStackEntry.arguments?.getString(&quot;status&quot;) ?: &quot;&quot;&#10;                val courseName = backStackEntry.arguments?.getString(&quot;courseName&quot;) ?: &quot;&quot;&#10;                val courseId = backStackEntry.arguments?.getInt(&quot;courseId&quot;) ?: 0&#10;                val scheduleId = backStackEntry.arguments?.getInt(&quot;scheduleId&quot;) ?: 0&#10;                SubmitionComplete(&#10;                    status = status,&#10;                    courseName = courseName,&#10;                    courseId = courseId,&#10;                    scheduleId = scheduleId,&#10;                    onBackClick = { navController.navigate(&quot;home&quot;) },&#10;                    onNavigateHome = { navController.navigate(&quot;home&quot;) }&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.smartattendance&#10;&#10;import android.app.Activity&#10;import android.graphics.Bitmap&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.animation.AnimatedVisibility&#10;import androidx.compose.animation.ExperimentalAnimationApi&#10;import androidx.compose.animation.core.FastOutSlowInEasing&#10;import androidx.compose.animation.core.tween&#10;import androidx.compose.animation.fadeIn&#10;import androidx.compose.animation.fadeOut&#10;import androidx.compose.animation.slideInHorizontally&#10;import androidx.compose.animation.slideInVertically&#10;import androidx.compose.animation.slideOutHorizontally&#10;import androidx.compose.animation.slideOutVertically&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Surface&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.SideEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.core.view.WindowCompat&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.screens.AttendanceDetailScreen&#10;import com.example.smartattendance.ui.screens.AttendanceScreen&#10;import com.example.smartattendance.ui.screens.CameraScreen&#10;import com.example.smartattendance.ui.screens.HistoryScreen&#10;import com.example.smartattendance.ui.screens.HomeScreen&#10;import com.example.smartattendance.ui.screens.ListScreen&#10;import com.example.smartattendance.ui.screens.LoginScreen&#10;import com.example.smartattendance.ui.screens.RequestPermissionScreen&#10;import com.example.smartattendance.ui.screens.ScheduleScreen&#10;import com.example.smartattendance.ui.screens.ScheduleDetailScreen&#10;import com.example.smartattendance.ui.screens.SignUpScreen&#10;import com.example.smartattendance.ui.screens.SubmissionCompleteScreen&#10;import com.example.smartattendance.ui.screens.SubmitAttendanceScreen&#10;import com.example.smartattendance.ui.screens.CreatePermissionFormScreen&#10;import com.example.smartattendance.ui.theme.SmartAttendanceTheme&#10;import com.example.smartattendance.utils.SessionManager&#10;import androidx.navigation.NavType&#10;import androidx.navigation.navArgument&#10;import com.example.smartattendance.ui.screens.SubmissionScreen&#10;import com.example.smartattendance.ui.screens.SubmitionComplete&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        // This enables edge-to-edge display and makes the status bar transparent.&#10;        enableEdgeToEdge()&#10;&#10;        setContent {&#10;            SmartAttendanceTheme {&#10;                Surface(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    color = Color.White&#10;                ) {&#10;                    AppNavigation()&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@OptIn(ExperimentalMaterial3Api::class, ExperimentalAnimationApi::class)&#10;@Composable&#10;fun AppNavigation() {&#10;    val navController = rememberNavController()&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentRoute = navBackStackEntry?.destination?.route ?: &quot;login&quot;&#10;    // Initialize SessionManager&#10;    val context = LocalView.current.context&#10;    val sessionManager = remember { SessionManager(context) }&#10;&#10;    // State for captured photo and attendance detail parameters&#10;    var capturedPhoto by remember { mutableStateOf&lt;Bitmap?&gt;(null) }&#10;    var isLateAttendance by remember { mutableStateOf(false) }&#10;    var selectedClassName by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedStatus by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedCourseCode by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedLecturerId by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedRoom by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedDay by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedStartTime by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedEndTime by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedAttendanceDate by remember { mutableStateOf(&quot;&quot;) }&#10;    var selectedRecordedAt by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // State to hold the current user&#10;    var user by remember { mutableStateOf&lt;AuthApi.User?&gt;(null) }&#10;&#10;    // Check session on app start&#10;    var startDestination by remember { mutableStateOf(&quot;login&quot;) }&#10;    LaunchedEffect(Unit) {&#10;        sessionManager.userFlow.collect { savedUser -&gt;&#10;            if (savedUser != null) {&#10;                user = savedUser&#10;                startDestination = &quot;home&quot;&#10;            } else {&#10;                startDestination = &quot;login&quot;&#10;            }&#10;        }&#10;    }&#10;&#10;&#10;    // --- Dynamic Status Bar Color ---&#10;    val view = LocalView.current&#10;    // This effect runs whenever the currentRoute changes.&#10;    // It adjusts the status bar icon color based on the screen's background.&#10;    if (!view.isInEditMode) {&#10;        SideEffect {&#10;            val window = (view.context as Activity).window&#10;            // When on 'home' screen (dark header), icons are light (false).&#10;            // On other screens (light background), icons are dark (true).&#10;            WindowCompat.getInsetsController(window, view).isAppearanceLightStatusBars = currentRoute != &quot;home&quot;&#10;        }&#10;    }&#10;    // --- End of Status Bar Logic ---&#10;&#10;    // Routes where bottom navigation should be shown&#10;    val routesWithBottomNav = setOf(&quot;home&quot;, &quot;attendance&quot;, &quot;history&quot;, &quot;schedule&quot;, &quot;request_permission&quot;, &quot;create_permission_request&quot;, &quot;submission_complete&quot;, &quot;pending_request&quot;)&#10;&#10;    Scaffold(&#10;        bottomBar = {&#10;            AnimatedVisibility(&#10;                visible = currentRoute in routesWithBottomNav,&#10;                enter = slideInVertically(&#10;                    initialOffsetY = { it },&#10;                    animationSpec = tween(300, easing = FastOutSlowInEasing)&#10;                ) + fadeIn(animationSpec = tween(300)),&#10;                exit = slideOutVertically(&#10;                    targetOffsetY = { it },&#10;                    animationSpec = tween(300, easing = FastOutSlowInEasing)&#10;                ) + fadeOut(animationSpec = tween(300))&#10;            ) {&#10;                AppBottomNavigation(&#10;                    currentRoute = currentRoute,&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;        }&#10;    ) { paddingValues -&gt;&#10;        NavHost(&#10;            navController = navController,&#10;            startDestination = startDestination,&#10;            modifier = Modifier.padding(paddingValues),&#10;            enterTransition = { slideInHorizontally(initialOffsetX = { it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeIn(animationSpec = tween(300)) },&#10;            exitTransition = { slideOutHorizontally(targetOffsetX = { -it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeOut(animationSpec = tween(300)) },&#10;            popEnterTransition = { slideInHorizontally(initialOffsetX = { -it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeIn(animationSpec = tween(300)) },&#10;            popExitTransition = { slideOutHorizontally(targetOffsetX = { it }, animationSpec = tween(300, easing = FastOutSlowInEasing)) + fadeOut(animationSpec = tween(300)) }&#10;        ) {&#10;            composable(&#10;                &quot;login&quot;,&#10;                enterTransition = { fadeIn(animationSpec = tween(500)) },&#10;                exitTransition = { fadeOut(animationSpec = tween(300)) }&#10;            ) {&#10;                LoginScreen(&#10;                    sessionManager = sessionManager,&#10;                    onLoginSuccess = { loggedInUser -&gt;&#10;                        user = loggedInUser&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;login&quot;) { inclusive = true }&#10;                        }&#10;                    },&#10;                    onSignUpClick = {&#10;                        navController.navigate(&quot;sign_up&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;sign_up&quot;&#10;            ){&#10;                SignUpScreen(&#10;                    onNavigateToLogin ={&#10;                        navController.navigate(&quot;login&quot;){&#10;                            popUpTo(0)&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;home&quot;) {&#10;                HomeScreen(&#10;                    user = user,&#10;                    sessionManager = sessionManager,&#10;                    navController = navController,&#10;                    onLogout = {&#10;                        user = null // Clear user on logout&#10;                        navController.navigate(&quot;login&quot;) {&#10;                            popUpTo(0)&#10;                        }&#10;                    },&#10;                    onDateClick = {&#10;                        navController.navigate(&quot;history&quot;)&#10;                    },&#10;                    onRequestPermission = {&#10;                        navController.navigate(&quot;request_permission&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;attendance&quot;) {&#10;                AttendanceScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onTakePhoto = {&#10;                        navController.navigate(&quot;camera&quot;)&#10;                    },&#10;                    onAskPermission = {&#10;                        navController.navigate(&quot;request_permission&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;camera&quot;) {&#10;                CameraScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onPhotoTaken = { bitmap -&gt;&#10;                        capturedPhoto = bitmap&#10;                        isLateAttendance = false&#10;                        navController.navigate(&quot;submit_attendance&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;submit_attendance&quot;) {&#10;                SubmitAttendanceScreen(&#10;                    capturedPhoto = capturedPhoto,&#10;                    isLateAttendance = isLateAttendance,&#10;                    onBackClick = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    },&#10;                    onTakePhotoClick = {&#10;                        navController.navigate(&quot;camera&quot;)&#10;                    },&#10;                    onSubmitSuccess = {&#10;                        capturedPhoto = null&#10;                        isLateAttendance = false&#10;                        navController.navigate(&quot;submission_complete&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = false }&#10;                            launchSingleTop = true&#10;                        }&#10;                    },&#10;                    onNavigateHome = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;history&quot;) {&#10;                HistoryScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigateToDetail = { className, status, courseCode, lecturerId, room, day, startTime, endTime, attendanceDate, recordedAt -&gt;&#10;                        selectedClassName = className&#10;                        selectedStatus = status&#10;                        selectedCourseCode = courseCode&#10;                        selectedLecturerId = lecturerId&#10;                        selectedRoom = room&#10;                        selectedDay = day&#10;                        selectedStartTime = startTime&#10;                        selectedEndTime = endTime&#10;                        selectedAttendanceDate = attendanceDate&#10;                        selectedRecordedAt = recordedAt&#10;                        navController.navigate(&quot;attendance_detail&quot;)&#10;                    },&#10;                    onNavigateToSchedule = {&#10;                        navController.navigate(&quot;schedule&quot;) {&#10;                            popUpTo(&quot;home&quot;) { saveState = true }&#10;                            launchSingleTop = true&#10;                            restoreState = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;attendance_detail&quot;) {&#10;                AttendanceDetailScreen(&#10;                    className = selectedClassName,&#10;                    status = selectedStatus,&#10;                    courseCode = selectedCourseCode,&#10;                    lecturerId = selectedLecturerId,&#10;                    room = selectedRoom,&#10;                    day = selectedDay,&#10;                    startTime = selectedStartTime,&#10;                    endTime = selectedEndTime,&#10;                    attendanceDate = selectedAttendanceDate,&#10;                    recordedAt = selectedRecordedAt,&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    }&#10;                )&#10;            }&#10;&#10;            // List screen for center navigation&#10;            composable(&quot;list&quot;) {&#10;                ListScreen(&#10;                    onNavigateBack = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    },&#10;                    onCardClick = { className, status -&gt;&#10;                        selectedClassName = className&#10;                        selectedStatus = status&#10;                        navController.navigate(&quot;attendance_detail&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;schedule&quot;) {&#10;                ScheduleScreen(&#10;                    user = user,&#10;                    onNavigateBack = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    },&#10;                    onScheduleItemClick = { scheduleId, courseId -&gt;&#10;                        navController.navigate(&quot;schedule_detail/$scheduleId/$courseId&quot;)&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;schedule_detail/{scheduleId}/{courseId}&quot;,&#10;                arguments = listOf(&#10;                    navArgument(&quot;scheduleId&quot;) { type = NavType.IntType },&#10;                    navArgument(&quot;courseId&quot;) { type = NavType.IntType }&#10;                )&#10;            ) { backStackEntry -&gt;&#10;                val scheduleId = backStackEntry.arguments?.getInt(&quot;scheduleId&quot;) ?: 0&#10;                val courseId = backStackEntry.arguments?.getInt(&quot;courseId&quot;) ?: 0&#10;                ScheduleDetailScreen(&#10;                    scheduleId = scheduleId,&#10;                    courseId = courseId,&#10;                    userId = user?.user_id ?: &quot;&quot;,&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;submission_complete&quot;) {&#10;                SubmissionCompleteScreen(&#10;                    status = selectedStatus, // pass the selected status&#10;                    courseName = selectedClassName, // pass the selected class name&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onNavigateHome = {&#10;                        navController.navigate(&quot;home&quot;) {&#10;                            popUpTo(&quot;home&quot;) { inclusive = true }&#10;                            launchSingleTop = true&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;request_permission&quot;) {&#10;                RequestPermissionScreen(&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onCreateRequest = {&#10;                        // TODO: Navigate to create permission request screen&#10;                        navController.navigate(&quot;create_permission_form&quot;)&#10;                    },&#10;                    onNavigate = { route -&gt;&#10;                        when (route) {&#10;                            &quot;home&quot; -&gt; {&#10;                                navController.navigate(&quot;home&quot;) {&#10;                                    popUpTo(&quot;home&quot;) { inclusive = true }&#10;                                    launchSingleTop = true&#10;                                }&#10;                            }&#10;                            else -&gt; {&#10;                                navController.navigate(route) {&#10;                                    popUpTo(&quot;home&quot;) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&quot;create_permission_form&quot;) {&#10;                CreatePermissionFormScreen(&#10;                    user = user,&#10;                    onBackClick = {&#10;                        navController.popBackStack()&#10;                    },&#10;                    onSubmit = {&#10;                        navController.popBackStack()&#10;                    }&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;submission_screen/{scheduleId}/{courseId}&quot;,&#10;                arguments = listOf(&#10;                    navArgument(&quot;scheduleId&quot;) { type = androidx.navigation.NavType.IntType },&#10;                    navArgument(&quot;courseId&quot;) { type = androidx.navigation.NavType.IntType }&#10;                )&#10;            ) { backStackEntry -&gt;&#10;                val scheduleId = backStackEntry.arguments?.getInt(&quot;scheduleId&quot;)&#10;                val courseId = backStackEntry.arguments?.getInt(&quot;courseId&quot;)&#10;                SubmissionScreen(&#10;                    user = user,&#10;                    navController = navController,&#10;                    scheduleId = scheduleId,&#10;                    courseId = courseId&#10;                )&#10;            }&#10;&#10;            composable(&#10;                &quot;submission_complete_screen/{status}/{courseName}/{courseId}/{scheduleId}&quot;,&#10;                arguments = listOf(&#10;                    navArgument(&quot;status&quot;) { type = NavType.StringType },&#10;                    navArgument(&quot;courseName&quot;) { type = NavType.StringType },&#10;                    navArgument(&quot;courseId&quot;) { type = NavType.IntType },&#10;                    navArgument(&quot;scheduleId&quot;) { type = NavType.IntType }&#10;                )&#10;            ) { backStackEntry -&gt;&#10;                val status = backStackEntry.arguments?.getString(&quot;status&quot;) ?: &quot;&quot;&#10;                val courseName = backStackEntry.arguments?.getString(&quot;courseName&quot;) ?: &quot;&quot;&#10;                val courseId = backStackEntry.arguments?.getInt(&quot;courseId&quot;) ?: 0&#10;                val scheduleId = backStackEntry.arguments?.getInt(&quot;scheduleId&quot;) ?: 0&#10;                SubmitionComplete(&#10;                    status = status,&#10;                    courseName = courseName,&#10;                    courseId = courseId,&#10;                    scheduleId = scheduleId,&#10;                    onBackClick = { navController.navigate(&quot;home&quot;) },&#10;                    onNavigateHome = { navController.navigate(&quot;home&quot;) }&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/ScheduleDetailScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/ScheduleDetailScreen.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import android.app.Activity&#10;import android.util.Log&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import androidx.core.view.WindowCompat&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.ui.components.AppHeader&#10;import com.example.smartattendance.ui.components.HeaderType&#10;import com.example.smartattendance.ui.theme.AppFontFamily&#10;import io.github.jan.supabase.postgrest.postgrest&#10;import io.github.jan.supabase.postgrest.query.Columns&#10;import kotlinx.coroutines.launch&#10;import kotlinx.serialization.Serializable&#10;import java.text.SimpleDateFormat&#10;import java.util.*&#10;&#10;@Serializable&#10;data class ScheduleDetailInfo(&#10;    val schedule_id: Int,&#10;    val course_id: Int,&#10;    val day: String,&#10;    val start_time: String,&#10;    val end_time: String,&#10;    val room: String?,&#10;    val courses: CourseDetailInfo&#10;)&#10;&#10;@Serializable&#10;data class CourseDetailInfo(&#10;    val course_name: String,&#10;    val course_code: String,&#10;    val lecturer_id: String?,&#10;    val users: UserInfo?&#10;)&#10;&#10;@Serializable&#10;data class UserInfo(&#10;    val full_name: String&#10;)&#10;&#10;@Serializable&#10;data class EnrollmentInfo(&#10;    val enrollment_id: Int,&#10;    val course_id: Int&#10;)&#10;&#10;@Serializable&#10;data class AttendanceHistory(&#10;    val attendance_date: String,&#10;    val status: String,&#10;    val is_verified: Boolean&#10;)&#10;&#10;@Serializable&#10;data class EnrollmentCount(&#10;    val count: Int&#10;)&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ScheduleDetailScreen(&#10;    scheduleId: Int,&#10;    courseId: Int,&#10;    userId: String,&#10;    onBackClick: () -&gt; Unit&#10;) {&#10;    var isLoading by remember { mutableStateOf(true) }&#10;    var scheduleDetail by remember { mutableStateOf&lt;ScheduleDetailInfo?&gt;(null) }&#10;    var attendanceHistory by remember { mutableStateOf&lt;List&lt;AttendanceHistory&gt;&gt;(emptyList()) }&#10;    var enrollmentCount by remember { mutableStateOf(0) }&#10;    var errorMessage by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    val scope = rememberCoroutineScope()&#10;    val supabase = AuthApi.supabase&#10;&#10;    // Set status bar color&#10;    val view = LocalView.current&#10;    LaunchedEffect(Unit) {&#10;        val window = (view.context as? Activity)?.window&#10;        window?.let {&#10;            WindowCompat.setDecorFitsSystemWindows(it, false)&#10;            it.statusBarColor = android.graphics.Color.parseColor(&quot;#FF2C2D32&quot;)&#10;        }&#10;    }&#10;&#10;    // Load data&#10;    LaunchedEffect(scheduleId, courseId, userId) {&#10;        scope.launch {&#10;            try {&#10;                isLoading = true&#10;                errorMessage = null&#10;&#10;                // Get schedule detail with course info&#10;                val scheduleResponse = supabase.postgrest[&quot;schedules&quot;]&#10;                    .select(&#10;                        columns = Columns.raw(&#10;                            &quot;&quot;&quot;&#10;                            schedule_id,&#10;                            course_id,&#10;                            day,&#10;                            start_time,&#10;                            end_time,&#10;                            room,&#10;                            courses!inner(&#10;                                course_name,&#10;                                course_code,&#10;                                lecturer_id,&#10;                                users!inner(full_name)&#10;                            )&#10;                            &quot;&quot;&quot;.trimIndent()&#10;                        )&#10;                    ) {&#10;                        filter {&#10;                            eq(&quot;schedule_id&quot;, scheduleId)&#10;                        }&#10;                    }&#10;                    .decodeList&lt;ScheduleDetailInfo&gt;()&#10;&#10;                scheduleDetail = scheduleResponse.firstOrNull()&#10;&#10;                // Get enrollment_id for this user and course&#10;                val enrollmentResponse = supabase.postgrest[&quot;enrollments&quot;]&#10;                    .select(columns = Columns.list(&quot;enrollment_id&quot;, &quot;course_id&quot;)) {&#10;                        filter {&#10;                            eq(&quot;user_id&quot;, userId)&#10;                            eq(&quot;course_id&quot;, courseId)&#10;                        }&#10;                    }&#10;                    .decodeList&lt;EnrollmentInfo&gt;()&#10;&#10;                val enrollmentId = enrollmentResponse.firstOrNull()?.enrollment_id&#10;&#10;                // Get attendance history&#10;                if (enrollmentId != null) {&#10;                    val attendanceResponse = supabase.postgrest[&quot;attendances&quot;]&#10;                        .select(columns = Columns.list(&quot;attendance_date&quot;, &quot;status&quot;, &quot;is_verified&quot;)) {&#10;                            filter {&#10;                                eq(&quot;enrollment_id&quot;, enrollmentId)&#10;                                eq(&quot;schedule_id&quot;, scheduleId)&#10;                            }&#10;                        }&#10;                        .decodeList&lt;AttendanceHistory&gt;()&#10;&#10;                    attendanceHistory = attendanceResponse.sortedByDescending { it.attendance_date }&#10;                }&#10;&#10;                // Get number of students enrolled in this course&#10;                val countResponse = supabase.postgrest[&quot;enrollments&quot;]&#10;                    .select(columns = Columns.list(&quot;enrollment_id&quot;)) {&#10;                        filter {&#10;                            eq(&quot;course_id&quot;, courseId)&#10;                        }&#10;                    }&#10;                    .decodeList&lt;EnrollmentInfo&gt;()&#10;&#10;                enrollmentCount = countResponse.size&#10;&#10;            } catch (e: Exception) {&#10;                errorMessage = &quot;Failed to load schedule details: ${e.message}&quot;&#10;                Log.e(&quot;ScheduleDetailScreen&quot;, &quot;Error loading data&quot;, e)&#10;            } finally {&#10;                isLoading = false&#10;            }&#10;        }&#10;    }&#10;&#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(Color.White)&#10;    ) {&#10;        AppHeader(&#10;            title = &quot;Detail&quot;,&#10;            headerType = HeaderType.BACK,&#10;            onBackClick = onBackClick&#10;        )&#10;&#10;        if (isLoading) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .background(Color(0xFFF6F6F6)),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator(color = Color(0xFF2C2D32))&#10;            }&#10;        } else if (errorMessage != null) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .background(Color(0xFFF6F6F6)),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = errorMessage ?: &quot;Error&quot;,&#10;                    color = Color.Red,&#10;                    fontFamily = AppFontFamily&#10;                )&#10;            }&#10;        } else {&#10;            scheduleDetail?.let { detail -&gt;&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxSize()&#10;                        .background(Color(0xFFF6F6F6))&#10;                        .verticalScroll(rememberScrollState())&#10;                        .padding(24.dp)&#10;                ) {&#10;                    // Detail Card&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                        elevation = CardDefaults.cardElevation(defaultElevation = 13.dp),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier.padding(16.dp)&#10;                        ) {&#10;                            Text(&#10;                                &quot;Detail&quot;,&#10;                                color = Color(0xFF2C2D32),&#10;                                fontSize = 18.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontFamily = AppFontFamily,&#10;                                modifier = Modifier.padding(bottom = 16.dp)&#10;                            )&#10;&#10;                            DetailRow(&quot;Course&quot;, detail.courses.course_name)&#10;                            DetailRow(&quot;Dosen&quot;, detail.courses.users?.full_name ?: &quot;N/A&quot;)&#10;                            DetailRow(&quot;Number of attendees&quot;, &quot;$enrollmentCount/16&quot;)&#10;                            DetailRow(&quot;Room&quot;, detail.room ?: &quot;N/A&quot;, isLast = true)&#10;                        }&#10;                    }&#10;&#10;                    // Attendance Status Card&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                        elevation = CardDefaults.cardElevation(defaultElevation = 13.dp),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier.padding(16.dp)&#10;                        ) {&#10;                            Text(&#10;                                &quot;Attendance status&quot;,&#10;                                color = Color(0xFF2C2D32),&#10;                                fontSize = 18.sp,&#10;                                fontWeight = FontWeight.Bold,&#10;                                fontFamily = AppFontFamily,&#10;                                modifier = Modifier.padding(bottom = 16.dp)&#10;                            )&#10;&#10;                            if (attendanceHistory.isEmpty()) {&#10;                                Text(&#10;                                    &quot;No attendance records yet&quot;,&#10;                                    color = Color.Gray,&#10;                                    fontSize = 14.sp,&#10;                                    fontFamily = AppFontFamily,&#10;                                    modifier = Modifier.padding(vertical = 8.dp)&#10;                                )&#10;                            } else {&#10;                                attendanceHistory.forEach { attendance -&gt;&#10;                                    AttendanceRow(&#10;                                        date = formatDate(attendance.attendance_date),&#10;                                        status = attendance.status&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun DetailRow(&#10;    label: String,&#10;    value: String,&#10;    isLast: Boolean = false&#10;) {&#10;    Row(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(bottom = if (isLast) 0.dp else 12.dp),&#10;        horizontalArrangement = Arrangement.SpaceBetween,&#10;        verticalAlignment = Alignment.Top&#10;    ) {&#10;        Text(&#10;            label,&#10;            color = Color(0xFF2C2D32),&#10;            fontSize = 14.sp,&#10;            fontFamily = AppFontFamily,&#10;            modifier = Modifier.weight(1f)&#10;        )&#10;        Text(&#10;            value,&#10;            color = Color(0xFF2C2D32),&#10;            fontSize = 14.sp,&#10;            fontFamily = AppFontFamily,&#10;            modifier = Modifier.weight(1f),&#10;            textAlign = androidx.compose.ui.text.style.TextAlign.End&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AttendanceRow(&#10;    date: String,&#10;    status: String&#10;) {&#10;    val statusColor = when (status.lowercase()) {&#10;        &quot;present&quot; -&gt; Color(0xFF00CC2C)&#10;        &quot;late&quot; -&gt; Color(0xFFFF9D00)&#10;        &quot;absent&quot; -&gt; Color(0xFFE53E3E)&#10;        &quot;excused&quot; -&gt; Color(0xFF2196F3)&#10;        &quot;sick&quot; -&gt; Color(0xFF9C27B0)&#10;        else -&gt; Color.Gray&#10;    }&#10;&#10;    Row(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(bottom = 8.dp),&#10;        horizontalArrangement = Arrangement.SpaceBetween,&#10;        verticalAlignment = Alignment.CenterVertically&#10;    ) {&#10;        Text(&#10;            date,&#10;            color = Color(0xFF2C2D32),&#10;            fontSize = 14.sp,&#10;            fontFamily = AppFontFamily&#10;        )&#10;        Text(&#10;            status.uppercase(),&#10;            color = statusColor,&#10;            fontSize = 14.sp,&#10;            fontWeight = FontWeight.Bold,&#10;            fontFamily = AppFontFamily&#10;        )&#10;    }&#10;}&#10;&#10;private fun formatDate(dateString: String): String {&#10;    return try {&#10;        val inputFormat = SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault())&#10;        val outputFormat = SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault())&#10;        val date = inputFormat.parse(dateString)&#10;        if (date != null) outputFormat.format(date) else dateString&#10;    } catch (e: Exception) {&#10;        dateString&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/ScheduleScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/ScheduleScreen.kt" />
              <option name="originalContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.animation.*&#10;import androidx.compose.animation.core.*&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.gestures.detectHorizontalDragGestures&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.ArrowBack&#10;import androidx.compose.material.icons.automirrored.filled.ArrowForward&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.input.pointer.pointerInput&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.core.view.WindowCompat&#10;import androidx.core.view.WindowInsetsControllerCompat&#10;import android.app.Activity&#10;import android.util.Log&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.api.ScheduleApi&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.components.AppHeader&#10;import com.example.smartattendance.ui.components.HeaderType&#10;import com.example.smartattendance.ui.theme.AppFontFamily&#10;import com.example.smartattendance.utils.SessionManager&#10;import kotlinx.coroutines.launch&#10;import kotlin.math.abs&#10;import androidx.compose.material3.pulltorefresh.PullToRefreshBox&#10;import androidx.compose.material3.pulltorefresh.rememberPullToRefreshState&#10;&#10;@Composable&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;fun ScheduleScreen(&#10;    user: AuthApi.User?,&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigate: (String) -&gt; Unit,&#10;    onSubmitAttendance: () -&gt; Unit = {},&#10;    onScheduleItemClick: (Int, Int) -&gt; Unit = { _, _ -&gt; }&#10;) {&#10;    val darkGray = Color(0xFF2C2D32)&#10;    val coroutineScope = rememberCoroutineScope()&#10;&#10;    // Set status bar color to match header&#10;    val view = LocalView.current&#10;    LaunchedEffect(Unit) {&#10;        val window = (view.context as? Activity)?.window&#10;        window?.let {&#10;            WindowCompat.setDecorFitsSystemWindows(it, false)&#10;            val controller = WindowInsetsControllerCompat(it, view)&#10;            controller.isAppearanceLightStatusBars = false // White icons on dark background&#10;            it.statusBarColor = 0xFF2C2D32.toInt()&#10;        }&#10;    }&#10;&#10;    // State for schedules&#10;    var weekSchedule by remember { mutableStateOf&lt;List&lt;DayScheduleData&gt;&gt;(emptyList()) }&#10;    var todaySchedule by remember { mutableStateOf&lt;List&lt;ScheduleItemUI&gt;&gt;(emptyList()) }&#10;    var isLoading by remember { mutableStateOf(false) }&#10;    var errorMessage by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var selectedDayIndex by remember { mutableStateOf(getCurrentDayIndex()) }&#10;    var isRefreshing by remember { mutableStateOf(false) }&#10;&#10;    // Initialize ScheduleApi&#10;    val scheduleApi = remember { ScheduleApi(AuthApi.supabase) }&#10;&#10;    // Get current day info&#10;    val currentDayName = remember { getCurrentDayName() }&#10;    val todayDate = remember {&#10;        val today = java.time.LocalDate.now()&#10;        val formatter = java.time.format.DateTimeFormatter.ofPattern(&quot;EEEE, dd MMMM yyyy&quot;, java.util.Locale.ENGLISH)&#10;        today.format(formatter)&#10;    }&#10;&#10;    // Function to load all schedules&#10;    suspend fun loadSchedules() {&#10;        user?.user_id?.let { userId -&gt;&#10;            Log.d(&quot;ScheduleScreen&quot;, &quot;=== Loading schedules for user: $userId ===&quot;)&#10;            errorMessage = null&#10;&#10;            try {&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Fetching schedules for user: $userId&quot;)&#10;&#10;                // Fetch week schedules&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Calling getUserSchedules...&quot;)&#10;                val weekResult = scheduleApi.getUserSchedules(userId)&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;getUserSchedules returned&quot;)&#10;&#10;                weekResult.fold(&#10;                    onSuccess = { schedules -&gt;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Week schedules SUCCESS: ${schedules.size} days&quot;)&#10;                        weekSchedule = schedules.map { daySchedule -&gt;&#10;                            DayScheduleData(&#10;                                dayName = daySchedule.dayName,&#10;                                schedules = daySchedule.schedules.map { apiSchedule -&gt;&#10;                                    ScheduleItemUI(&#10;                                        scheduleId = apiSchedule.scheduleId,&#10;                                        courseId = apiSchedule.courseId,&#10;                                        title = apiSchedule.title,&#10;                                        time = apiSchedule.time,&#10;                                        room = apiSchedule.room&#10;                                    )&#10;                                }&#10;                            )&#10;                        }&#10;&#10;                        // Set selectedDayIndex to today's day&#10;                        val todayIndex = weekSchedule.indexOfFirst { it.dayName == currentDayName }&#10;                        if (todayIndex != -1) {&#10;                            selectedDayIndex = todayIndex&#10;                            Log.d(&quot;ScheduleScreen&quot;, &quot;Set selectedDayIndex to today: $todayIndex ($currentDayName)&quot;)&#10;                        }&#10;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Week schedules mapped successfully&quot;)&#10;                    },&#10;                    onFailure = { error -&gt;&#10;                        errorMessage = error.message ?: &quot;Failed to load schedules&quot;&#10;                        Log.e(&quot;ScheduleScreen&quot;, &quot;Week schedules FAILURE: ${error.message}&quot;, error)&#10;                    }&#10;                )&#10;&#10;                // Fetch today's schedules&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Calling getTodaySchedules...&quot;)&#10;                val todayResult = scheduleApi.getTodaySchedules(userId)&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;getTodaySchedules returned&quot;)&#10;&#10;                todayResult.fold(&#10;                    onSuccess = { schedules -&gt;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Today schedules SUCCESS: ${schedules.size} items&quot;)&#10;                        todaySchedule = schedules.map { apiSchedule -&gt;&#10;                            ScheduleItemUI(&#10;                                scheduleId = apiSchedule.scheduleId,&#10;                                courseId = apiSchedule.courseId,&#10;                                title = apiSchedule.title,&#10;                                time = apiSchedule.time,&#10;                                room = apiSchedule.room&#10;                            )&#10;                        }&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Today schedules mapped successfully&quot;)&#10;                    },&#10;                    onFailure = { error -&gt;&#10;                        Log.e(&quot;ScheduleScreen&quot;, &quot;Today schedules FAILURE: ${error.message}&quot;, error)&#10;                    }&#10;                )&#10;            } catch (e: Exception) {&#10;                errorMessage = e.message ?: &quot;Unknown error occurred&quot;&#10;                Log.e(&quot;ScheduleScreen&quot;, &quot;=== EXCEPTION in loadSchedules ===&quot;, e)&#10;                Log.e(&quot;ScheduleScreen&quot;, &quot;Exception message: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;&#10;    // Fetch schedules from database&#10;    LaunchedEffect(user?.user_id) {&#10;        isLoading = true&#10;        loadSchedules()&#10;        isLoading = false&#10;    }&#10;&#10;    PullToRefreshBox(&#10;        isRefreshing = isRefreshing,&#10;        onRefresh = {&#10;            coroutineScope.launch {&#10;                isRefreshing = true&#10;                loadSchedules()&#10;                isRefreshing = false&#10;            }&#10;        },&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .background(Color.White)&#10;        ) {&#10;            // Header&#10;            AppHeader(&#10;                title = &quot;Schedule&quot;,&#10;            headerType = HeaderType.BACK,&#10;            onBackClick = onNavigateBack&#10;        )&#10;&#10;        // Content Area - Make everything scrollable&#10;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .weight(1f)&#10;                .fillMaxWidth()&#10;                .background(Color(0xFFF6F6F6))&#10;                .padding(start = 24.dp, end = 24.dp),&#10;            verticalArrangement = Arrangement.spacedBy(0.dp)&#10;        ) {&#10;            item {&#10;                // Schedule Title&#10;                Text(&#10;                    text = &quot;Schedule&quot;,&#10;                    fontFamily = AppFontFamily,&#10;                    fontWeight = FontWeight.Bold,&#10;                    fontSize = 24.sp,&#10;                    color = Color.Black,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 16.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                if (isLoading) {&#10;                    // Loading state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        CircularProgressIndicator(&#10;                            color = Color(0xFF2C2D32)&#10;                        )&#10;                    }&#10;                } else if (errorMessage != null) {&#10;                    // Error state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&#10;                            text = errorMessage ?: &quot;Failed to load schedules&quot;,&#10;                            color = Color.Red,&#10;                            fontFamily = AppFontFamily,&#10;                            fontSize = 14.sp,&#10;                            textAlign = TextAlign.Center&#10;                        )&#10;                    }&#10;                } else if (weekSchedule.isEmpty()) {&#10;                    // Empty state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&#10;                            text = &quot;No schedules found&quot;,&#10;                            color = Color.Gray,&#10;                            fontFamily = AppFontFamily,&#10;                            fontSize = 14.sp&#10;                        )&#10;                    }&#10;                } else {&#10;                    // Swipe gesture detector for day navigation&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .pointerInput(selectedDayIndex) {&#10;                                detectHorizontalDragGestures(&#10;                                    onDragEnd = {&#10;                                        // Reset drag state after gesture ends&#10;                                    }&#10;                                ) { _, dragAmount -&gt;&#10;                                    // Swipe left (negative dragAmount) to show next day&#10;                                    if (dragAmount &lt; -30 &amp;&amp; selectedDayIndex &lt; weekSchedule.size - 1) {&#10;                                        selectedDayIndex++&#10;                                    }&#10;                                    // Swipe right (positive dragAmount) to show previous day&#10;                                    else if (dragAmount &gt; 30 &amp;&amp; selectedDayIndex &gt; 0) {&#10;                                        selectedDayIndex--&#10;                                    }&#10;                                }&#10;                            }&#10;                    ) {&#10;                        AnimatedContent(&#10;                            targetState = selectedDayIndex,&#10;                            transitionSpec = {&#10;                                val isMovingForward = targetState &gt; initialState&#10;                                slideInHorizontally(&#10;                                    initialOffsetX = { fullWidth -&gt;&#10;                                        if (isMovingForward) fullWidth else -fullWidth&#10;                                    },&#10;                                    animationSpec = tween(durationMillis = 300, easing = FastOutSlowInEasing)&#10;                                ) + fadeIn() togetherWith&#10;                                        slideOutHorizontally(&#10;                                            targetOffsetX = { fullWidth -&gt;&#10;                                                if (isMovingForward) -fullWidth else fullWidth&#10;                                            },&#10;                                            animationSpec = tween(durationMillis = 300, easing = FastOutSlowInEasing)&#10;                                        ) + fadeOut()&#10;                            },&#10;                            label = &quot;schedule_animation&quot;&#10;                        ) { dayIndex -&gt;&#10;                            val dayData = weekSchedule[dayIndex]&#10;                            DayScheduleCard(&#10;                                dayName = dayData.dayName,&#10;                                schedules = dayData.schedules,&#10;                                isSelected = true,&#10;                                onCardClick = { },&#10;                                onSubmitAttendance = onSubmitAttendance,&#10;                                onScheduleItemClick = onScheduleItemClick,&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Dots Indicator - only show if schedules are loaded&#10;                if (!isLoading &amp;&amp; weekSchedule.isNotEmpty()) {&#10;                    Row(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(vertical = 24.dp),&#10;                        horizontalArrangement = Arrangement.Center&#10;                    ) {&#10;                        repeat(weekSchedule.size) { index -&gt;&#10;                            Box(&#10;                                modifier = Modifier&#10;                                    .size(if (index == selectedDayIndex) 10.dp else 8.dp)&#10;                                    .clip(CircleShape)&#10;                                    .background(&#10;                                        if (index == selectedDayIndex) Color(0xFF2C2D32)&#10;                                        else Color.Gray.copy(alpha = 0.3f)&#10;                                    )&#10;                                    .clickable {&#10;                                        selectedDayIndex = index&#10;                                    }&#10;                            )&#10;                            if (index &lt; weekSchedule.size - 1) {&#10;                                Spacer(modifier = Modifier.width(8.dp))&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Today Section title with date&#10;                Column(modifier = Modifier.padding(bottom = 16.dp)) {&#10;                    Text(&#10;                        text = &quot;Today&quot;,&#10;                        fontFamily = AppFontFamily,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 24.sp,&#10;                        color = Color.Black&#10;                    )&#10;                    Text(&#10;                        text = todayDate,&#10;                        fontFamily = AppFontFamily,&#10;                        fontSize = 14.sp,&#10;                        color = Color.Gray,&#10;                        modifier = Modifier.padding(top = 4.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Notification Banner - conditional based on whether there are schedules today&#10;                if (todaySchedule.isNotEmpty()) {&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFF2C2D32)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Text(&#10;                            text = &quot;The attendance submission period is 15 minutes from the start of class.&quot;,&#10;                            fontFamily = AppFontFamily,&#10;                            color = Color.White,&#10;                            fontSize = 12.sp,&#10;                            modifier = Modifier.padding(12.dp)&#10;                        )&#10;                    }&#10;                } else {&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFFF0F0F0)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(24.dp),&#10;                            horizontalAlignment = Alignment.CenterHorizontally&#10;                        ) {&#10;                            Text(&#10;                                text = &quot;No Schedule Today&quot;,&#10;                                fontFamily = AppFontFamily,&#10;                                fontWeight = FontWeight.Medium,&#10;                                color = Color.Gray,&#10;                                fontSize = 14.sp,&#10;                                textAlign = TextAlign.Center&#10;                            )&#10;                            Text(&#10;                                text = &quot;Enjoy your free time!&quot;,&#10;                                fontFamily = AppFontFamily,&#10;                                color = Color.Gray.copy(alpha = 0.7f),&#10;                                fontSize = 12.sp,&#10;                                textAlign = TextAlign.Center,&#10;                                modifier = Modifier.padding(top = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Today's Schedule items - only show if there are schedules&#10;            if (todaySchedule.isNotEmpty()) {&#10;                items(todaySchedule) { item -&gt;&#10;                    TodayScheduleItem(&#10;                        title = item.title,&#10;                        time = item.time,&#10;                        onSubmit = onSubmitAttendance&#10;                    ) {&#10;                        onScheduleItemClick(item.title, item.time)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun DayScheduleCard(&#10;    dayName: String,&#10;    schedules: List&lt;ScheduleItemUI&gt;,&#10;    isSelected: Boolean,&#10;    onCardClick: () -&gt; Unit,&#10;    onSubmitAttendance: () -&gt; Unit,&#10;    onScheduleItemClick: (String, String) -&gt; Unit = { _, _ -&gt; },&#10;    modifier: Modifier = Modifier&#10;) {&#10;    Card(&#10;        colors = CardDefaults.cardColors(Color.White),&#10;        elevation = CardDefaults.cardElevation(8.dp),&#10;        shape = RoundedCornerShape(12.dp)&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp)&#10;        ) {&#10;            Text(&#10;                text = dayName.uppercase(),&#10;                fontFamily = AppFontFamily,&#10;                fontWeight = FontWeight.Bold,&#10;                fontSize = 16.sp,&#10;                color = Color.Black,&#10;                textAlign = TextAlign.Center,&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(bottom = 16.dp)&#10;            )&#10;&#10;            // Classes for the day with dark background - make them clickable&#10;            Column(&#10;                modifier = Modifier.fillMaxSize(),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                schedules.forEach { schedule -&gt;&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .clickable {&#10;                                onScheduleItemClick(schedule.title, schedule.time)&#10;                            },&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFF2C2D32)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier.padding(12.dp)&#10;                        ) {&#10;                            Text(&#10;                                text = schedule.title,&#10;                                fontFamily = AppFontFamily,&#10;                                fontWeight = FontWeight.Medium,&#10;                                fontSize = 13.sp,&#10;                                color = Color.White,&#10;                                lineHeight = 16.sp&#10;                            )&#10;                            Text(&#10;                                text = schedule.time,&#10;                                fontFamily = AppFontFamily,&#10;                                fontSize = 11.sp,&#10;                                color = Color.White.copy(alpha = 0.7f),&#10;                                modifier = Modifier.padding(top = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun TodayScheduleItem(&#10;    title: String,&#10;    time: String,&#10;    onSubmit: () -&gt; Unit,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(bottom = 16.dp)&#10;            .clickable(onClick = onClick),&#10;        colors = CardDefaults.cardColors(containerColor = Color.White),&#10;        shape = RoundedCornerShape(8.dp),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            horizontalArrangement = Arrangement.SpaceBetween,&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .weight(1f)&#10;                    .padding(end = 14.dp)&#10;            ) {&#10;                Text(&#10;                    text = title,&#10;                    fontFamily = AppFontFamily,&#10;                    fontWeight = FontWeight.Medium,&#10;                    fontSize = 14.sp,&#10;                    color = Color.Black&#10;                )&#10;                Text(&#10;                    text = time,&#10;                    fontFamily = AppFontFamily,&#10;                    fontSize = 12.sp,&#10;                    color = Color.Gray,&#10;                    modifier = Modifier.padding(top = 4.dp)&#10;                )&#10;            }&#10;&#10;            Button(&#10;                onClick = onSubmit,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = Color(0xFFE0697E)&#10;                ),&#10;                shape = RoundedCornerShape(6.dp),&#10;                modifier = Modifier.height(36.dp)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Submit&quot;,&#10;                    fontFamily = AppFontFamily,&#10;                    color = Color.White,&#10;                    fontSize = 12.sp&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;data class ScheduleItemUI(&#10;    val scheduleId: Int = 0,&#10;    val courseId: Int = 0,&#10;    val title: String,&#10;    val time: String,&#10;    val room: String? = null&#10;)&#10;&#10;data class DayScheduleData(&#10;    val dayName: String,&#10;    val schedules: List&lt;ScheduleItemUI&gt;&#10;)&#10;&#10;// Helper functions for current day&#10;private fun getCurrentDayName(): String {&#10;    val dayOfWeek = java.time.LocalDate.now().dayOfWeek&#10;    return when (dayOfWeek) {&#10;        java.time.DayOfWeek.MONDAY -&gt; &quot;Monday&quot;&#10;        java.time.DayOfWeek.TUESDAY -&gt; &quot;Tuesday&quot;&#10;        java.time.DayOfWeek.WEDNESDAY -&gt; &quot;Wednesday&quot;&#10;        java.time.DayOfWeek.THURSDAY -&gt; &quot;Thursday&quot;&#10;        java.time.DayOfWeek.FRIDAY -&gt; &quot;Friday&quot;&#10;        java.time.DayOfWeek.SATURDAY -&gt; &quot;Monday&quot; // Default to Monday for weekend&#10;        java.time.DayOfWeek.SUNDAY -&gt; &quot;Monday&quot; // Default to Monday for weekend&#10;    }&#10;}&#10;&#10;private fun getCurrentDayIndex(): Int {&#10;    val dayOfWeek = java.time.LocalDate.now().dayOfWeek&#10;    return when (dayOfWeek) {&#10;        java.time.DayOfWeek.MONDAY -&gt; 0&#10;        java.time.DayOfWeek.TUESDAY -&gt; 1&#10;        java.time.DayOfWeek.WEDNESDAY -&gt; 2&#10;        java.time.DayOfWeek.THURSDAY -&gt; 3&#10;        java.time.DayOfWeek.FRIDAY -&gt; 4&#10;        else -&gt; 0 // Default to Monday (index 0) for weekend&#10;    }&#10;}&#10;&#10;@Preview&#10;@Composable&#10;fun ScheduleScreenPreview() {&#10;    ScheduleScreen(&#10;        user = null,&#10;        onNavigateBack = {},&#10;        onNavigate = {},&#10;        onSubmitAttendance = {}&#10;    )&#10;}" />
              <option name="updatedContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.animation.*&#10;import androidx.compose.animation.core.*&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.gestures.detectHorizontalDragGestures&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.ArrowBack&#10;import androidx.compose.material.icons.automirrored.filled.ArrowForward&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.input.pointer.pointerInput&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.core.view.WindowCompat&#10;import androidx.core.view.WindowInsetsControllerCompat&#10;import android.app.Activity&#10;import android.util.Log&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.api.ScheduleApi&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.components.AppHeader&#10;import com.example.smartattendance.ui.components.HeaderType&#10;import com.example.smartattendance.ui.theme.AppFontFamily&#10;import com.example.smartattendance.utils.SessionManager&#10;import kotlinx.coroutines.launch&#10;import kotlin.math.abs&#10;import androidx.compose.material3.pulltorefresh.PullToRefreshBox&#10;import androidx.compose.material3.pulltorefresh.rememberPullToRefreshState&#10;&#10;@Composable&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;fun ScheduleScreen(&#10;    user: AuthApi.User?,&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigate: (String) -&gt; Unit,&#10;    onSubmitAttendance: () -&gt; Unit = {},&#10;    onScheduleItemClick: (Int, Int) -&gt; Unit = { _, _ -&gt; }&#10;) {&#10;    val darkGray = Color(0xFF2C2D32)&#10;    val coroutineScope = rememberCoroutineScope()&#10;&#10;    // Set status bar color to match header&#10;    val view = LocalView.current&#10;    LaunchedEffect(Unit) {&#10;        val window = (view.context as? Activity)?.window&#10;        window?.let {&#10;            WindowCompat.setDecorFitsSystemWindows(it, false)&#10;            val controller = WindowInsetsControllerCompat(it, view)&#10;            controller.isAppearanceLightStatusBars = false // White icons on dark background&#10;            it.statusBarColor = 0xFF2C2D32.toInt()&#10;        }&#10;    }&#10;&#10;    // State for schedules&#10;    var weekSchedule by remember { mutableStateOf&lt;List&lt;DayScheduleData&gt;&gt;(emptyList()) }&#10;    var todaySchedule by remember { mutableStateOf&lt;List&lt;ScheduleItemUI&gt;&gt;(emptyList()) }&#10;    var isLoading by remember { mutableStateOf(false) }&#10;    var errorMessage by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var selectedDayIndex by remember { mutableStateOf(getCurrentDayIndex()) }&#10;    var isRefreshing by remember { mutableStateOf(false) }&#10;&#10;    // Initialize ScheduleApi&#10;    val scheduleApi = remember { ScheduleApi(AuthApi.supabase) }&#10;&#10;    // Get current day info&#10;    val currentDayName = remember { getCurrentDayName() }&#10;    val todayDate = remember {&#10;        val today = java.time.LocalDate.now()&#10;        val formatter = java.time.format.DateTimeFormatter.ofPattern(&quot;EEEE, dd MMMM yyyy&quot;, java.util.Locale.ENGLISH)&#10;        today.format(formatter)&#10;    }&#10;&#10;    // Function to load all schedules&#10;    suspend fun loadSchedules() {&#10;        user?.user_id?.let { userId -&gt;&#10;            Log.d(&quot;ScheduleScreen&quot;, &quot;=== Loading schedules for user: $userId ===&quot;)&#10;            errorMessage = null&#10;&#10;            try {&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Fetching schedules for user: $userId&quot;)&#10;&#10;                // Fetch week schedules&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Calling getUserSchedules...&quot;)&#10;                val weekResult = scheduleApi.getUserSchedules(userId)&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;getUserSchedules returned&quot;)&#10;&#10;                weekResult.fold(&#10;                    onSuccess = { schedules -&gt;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Week schedules SUCCESS: ${schedules.size} days&quot;)&#10;                        weekSchedule = schedules.map { daySchedule -&gt;&#10;                            DayScheduleData(&#10;                                dayName = daySchedule.dayName,&#10;                                schedules = daySchedule.schedules.map { apiSchedule -&gt;&#10;                                    ScheduleItemUI(&#10;                                        scheduleId = apiSchedule.scheduleId,&#10;                                        courseId = apiSchedule.courseId,&#10;                                        title = apiSchedule.title,&#10;                                        time = apiSchedule.time,&#10;                                        room = apiSchedule.room&#10;                                    )&#10;                                }&#10;                            )&#10;                        }&#10;&#10;                        // Set selectedDayIndex to today's day&#10;                        val todayIndex = weekSchedule.indexOfFirst { it.dayName == currentDayName }&#10;                        if (todayIndex != -1) {&#10;                            selectedDayIndex = todayIndex&#10;                            Log.d(&quot;ScheduleScreen&quot;, &quot;Set selectedDayIndex to today: $todayIndex ($currentDayName)&quot;)&#10;                        }&#10;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Week schedules mapped successfully&quot;)&#10;                    },&#10;                    onFailure = { error -&gt;&#10;                        errorMessage = error.message ?: &quot;Failed to load schedules&quot;&#10;                        Log.e(&quot;ScheduleScreen&quot;, &quot;Week schedules FAILURE: ${error.message}&quot;, error)&#10;                    }&#10;                )&#10;&#10;                // Fetch today's schedules&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;Calling getTodaySchedules...&quot;)&#10;                val todayResult = scheduleApi.getTodaySchedules(userId)&#10;                Log.d(&quot;ScheduleScreen&quot;, &quot;getTodaySchedules returned&quot;)&#10;&#10;                todayResult.fold(&#10;                    onSuccess = { schedules -&gt;&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Today schedules SUCCESS: ${schedules.size} items&quot;)&#10;                        todaySchedule = schedules.map { apiSchedule -&gt;&#10;                            ScheduleItemUI(&#10;                                scheduleId = apiSchedule.scheduleId,&#10;                                courseId = apiSchedule.courseId,&#10;                                title = apiSchedule.title,&#10;                                time = apiSchedule.time,&#10;                                room = apiSchedule.room&#10;                            )&#10;                        }&#10;                        Log.d(&quot;ScheduleScreen&quot;, &quot;Today schedules mapped successfully&quot;)&#10;                    },&#10;                    onFailure = { error -&gt;&#10;                        Log.e(&quot;ScheduleScreen&quot;, &quot;Today schedules FAILURE: ${error.message}&quot;, error)&#10;                    }&#10;                )&#10;            } catch (e: Exception) {&#10;                errorMessage = e.message ?: &quot;Unknown error occurred&quot;&#10;                Log.e(&quot;ScheduleScreen&quot;, &quot;=== EXCEPTION in loadSchedules ===&quot;, e)&#10;                Log.e(&quot;ScheduleScreen&quot;, &quot;Exception message: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;&#10;    // Fetch schedules from database&#10;    LaunchedEffect(user?.user_id) {&#10;        isLoading = true&#10;        loadSchedules()&#10;        isLoading = false&#10;    }&#10;&#10;    PullToRefreshBox(&#10;        isRefreshing = isRefreshing,&#10;        onRefresh = {&#10;            coroutineScope.launch {&#10;                isRefreshing = true&#10;                loadSchedules()&#10;                isRefreshing = false&#10;            }&#10;        },&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .background(Color.White)&#10;        ) {&#10;            // Header&#10;            AppHeader(&#10;                title = &quot;Schedule&quot;,&#10;            headerType = HeaderType.BACK,&#10;            onBackClick = onNavigateBack&#10;        )&#10;&#10;        // Content Area - Make everything scrollable&#10;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .weight(1f)&#10;                .fillMaxWidth()&#10;                .background(Color(0xFFF6F6F6))&#10;                .padding(start = 24.dp, end = 24.dp),&#10;            verticalArrangement = Arrangement.spacedBy(0.dp)&#10;        ) {&#10;            item {&#10;                // Schedule Title&#10;                Text(&#10;                    text = &quot;Schedule&quot;,&#10;                    fontFamily = AppFontFamily,&#10;                    fontWeight = FontWeight.Bold,&#10;                    fontSize = 24.sp,&#10;                    color = Color.Black,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 16.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                if (isLoading) {&#10;                    // Loading state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        CircularProgressIndicator(&#10;                            color = Color(0xFF2C2D32)&#10;                        )&#10;                    }&#10;                } else if (errorMessage != null) {&#10;                    // Error state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&#10;                            text = errorMessage ?: &quot;Failed to load schedules&quot;,&#10;                            color = Color.Red,&#10;                            fontFamily = AppFontFamily,&#10;                            fontSize = 14.sp,&#10;                            textAlign = TextAlign.Center&#10;                        )&#10;                    }&#10;                } else if (weekSchedule.isEmpty()) {&#10;                    // Empty state&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(300.dp),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&#10;                            text = &quot;No schedules found&quot;,&#10;                            color = Color.Gray,&#10;                            fontFamily = AppFontFamily,&#10;                            fontSize = 14.sp&#10;                        )&#10;                    }&#10;                } else {&#10;                    // Swipe gesture detector for day navigation&#10;                    Box(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .pointerInput(selectedDayIndex) {&#10;                                detectHorizontalDragGestures(&#10;                                    onDragEnd = {&#10;                                        // Reset drag state after gesture ends&#10;                                    }&#10;                                ) { _, dragAmount -&gt;&#10;                                    // Swipe left (negative dragAmount) to show next day&#10;                                    if (dragAmount &lt; -30 &amp;&amp; selectedDayIndex &lt; weekSchedule.size - 1) {&#10;                                        selectedDayIndex++&#10;                                    }&#10;                                    // Swipe right (positive dragAmount) to show previous day&#10;                                    else if (dragAmount &gt; 30 &amp;&amp; selectedDayIndex &gt; 0) {&#10;                                        selectedDayIndex--&#10;                                    }&#10;                                }&#10;                            }&#10;                    ) {&#10;                        AnimatedContent(&#10;                            targetState = selectedDayIndex,&#10;                            transitionSpec = {&#10;                                val isMovingForward = targetState &gt; initialState&#10;                                slideInHorizontally(&#10;                                    initialOffsetX = { fullWidth -&gt;&#10;                                        if (isMovingForward) fullWidth else -fullWidth&#10;                                    },&#10;                                    animationSpec = tween(durationMillis = 300, easing = FastOutSlowInEasing)&#10;                                ) + fadeIn() togetherWith&#10;                                        slideOutHorizontally(&#10;                                            targetOffsetX = { fullWidth -&gt;&#10;                                                if (isMovingForward) -fullWidth else fullWidth&#10;                                            },&#10;                                            animationSpec = tween(durationMillis = 300, easing = FastOutSlowInEasing)&#10;                                        ) + fadeOut()&#10;                            },&#10;                            label = &quot;schedule_animation&quot;&#10;                        ) { dayIndex -&gt;&#10;                            val dayData = weekSchedule[dayIndex]&#10;                            DayScheduleCard(&#10;                                dayName = dayData.dayName,&#10;                                schedules = dayData.schedules,&#10;                                isSelected = true,&#10;                                onCardClick = { },&#10;                                onSubmitAttendance = onSubmitAttendance,&#10;                                onScheduleItemClick = onScheduleItemClick,&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Dots Indicator - only show if schedules are loaded&#10;                if (!isLoading &amp;&amp; weekSchedule.isNotEmpty()) {&#10;                    Row(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(vertical = 24.dp),&#10;                        horizontalArrangement = Arrangement.Center&#10;                    ) {&#10;                        repeat(weekSchedule.size) { index -&gt;&#10;                            Box(&#10;                                modifier = Modifier&#10;                                    .size(if (index == selectedDayIndex) 10.dp else 8.dp)&#10;                                    .clip(CircleShape)&#10;                                    .background(&#10;                                        if (index == selectedDayIndex) Color(0xFF2C2D32)&#10;                                        else Color.Gray.copy(alpha = 0.3f)&#10;                                    )&#10;                                    .clickable {&#10;                                        selectedDayIndex = index&#10;                                    }&#10;                            )&#10;                            if (index &lt; weekSchedule.size - 1) {&#10;                                Spacer(modifier = Modifier.width(8.dp))&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Today Section title with date&#10;                Column(modifier = Modifier.padding(bottom = 16.dp)) {&#10;                    Text(&#10;                        text = &quot;Today&quot;,&#10;                        fontFamily = AppFontFamily,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 24.sp,&#10;                        color = Color.Black&#10;                    )&#10;                    Text(&#10;                        text = todayDate,&#10;                        fontFamily = AppFontFamily,&#10;                        fontSize = 14.sp,&#10;                        color = Color.Gray,&#10;                        modifier = Modifier.padding(top = 4.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            item {&#10;                // Notification Banner - conditional based on whether there are schedules today&#10;                if (todaySchedule.isNotEmpty()) {&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFF2C2D32)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Text(&#10;                            text = &quot;The attendance submission period is 15 minutes from the start of class.&quot;,&#10;                            fontFamily = AppFontFamily,&#10;                            color = Color.White,&#10;                            fontSize = 12.sp,&#10;                            modifier = Modifier.padding(12.dp)&#10;                        )&#10;                    }&#10;                } else {&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(bottom = 16.dp),&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFFF0F0F0)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(24.dp),&#10;                            horizontalAlignment = Alignment.CenterHorizontally&#10;                        ) {&#10;                            Text(&#10;                                text = &quot;No Schedule Today&quot;,&#10;                                fontFamily = AppFontFamily,&#10;                                fontWeight = FontWeight.Medium,&#10;                                color = Color.Gray,&#10;                                fontSize = 14.sp,&#10;                                textAlign = TextAlign.Center&#10;                            )&#10;                            Text(&#10;                                text = &quot;Enjoy your free time!&quot;,&#10;                                fontFamily = AppFontFamily,&#10;                                color = Color.Gray.copy(alpha = 0.7f),&#10;                                fontSize = 12.sp,&#10;                                textAlign = TextAlign.Center,&#10;                                modifier = Modifier.padding(top = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Today's Schedule items - only show if there are schedules&#10;            if (todaySchedule.isNotEmpty()) {&#10;                items(todaySchedule) { item -&gt;&#10;                    TodayScheduleItem(&#10;                        title = item.title,&#10;                        time = item.time,&#10;                        onSubmit = onSubmitAttendance&#10;                    ) {&#10;                        onScheduleItemClick(item.scheduleId, item.courseId)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun DayScheduleCard(&#10;    dayName: String,&#10;    schedules: List&lt;ScheduleItemUI&gt;,&#10;    isSelected: Boolean,&#10;    onCardClick: () -&gt; Unit,&#10;    onSubmitAttendance: () -&gt; Unit,&#10;    onScheduleItemClick: (Int, Int) -&gt; Unit = { _, _ -&gt; },&#10;    modifier: Modifier = Modifier&#10;) {&#10;    Card(&#10;        colors = CardDefaults.cardColors(Color.White),&#10;        elevation = CardDefaults.cardElevation(8.dp),&#10;        shape = RoundedCornerShape(12.dp)&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp)&#10;        ) {&#10;            Text(&#10;                text = dayName.uppercase(),&#10;                fontFamily = AppFontFamily,&#10;                fontWeight = FontWeight.Bold,&#10;                fontSize = 16.sp,&#10;                color = Color.Black,&#10;                textAlign = TextAlign.Center,&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(bottom = 16.dp)&#10;            )&#10;&#10;            // Classes for the day with dark background - make them clickable&#10;            Column(&#10;                modifier = Modifier.fillMaxSize(),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                schedules.forEach { schedule -&gt;&#10;                    Card(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .clickable {&#10;                                onScheduleItemClick(schedule.scheduleId, schedule.courseId)&#10;                            },&#10;                        colors = CardDefaults.cardColors(containerColor = Color(0xFF2C2D32)),&#10;                        shape = RoundedCornerShape(8.dp)&#10;                    ) {&#10;                        Column(&#10;                            modifier = Modifier.padding(12.dp)&#10;                        ) {&#10;                            Text(&#10;                                text = schedule.title,&#10;                                fontFamily = AppFontFamily,&#10;                                fontWeight = FontWeight.Medium,&#10;                                fontSize = 13.sp,&#10;                                color = Color.White,&#10;                                lineHeight = 16.sp&#10;                            )&#10;                            Text(&#10;                                text = schedule.time,&#10;                                fontFamily = AppFontFamily,&#10;                                fontSize = 11.sp,&#10;                                color = Color.White.copy(alpha = 0.7f),&#10;                                modifier = Modifier.padding(top = 4.dp)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun TodayScheduleItem(&#10;    title: String,&#10;    time: String,&#10;    onSubmit: () -&gt; Unit,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(bottom = 16.dp)&#10;            .clickable(onClick = onClick),&#10;        colors = CardDefaults.cardColors(containerColor = Color.White),&#10;        shape = RoundedCornerShape(8.dp),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            horizontalArrangement = Arrangement.SpaceBetween,&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .weight(1f)&#10;                    .padding(end = 14.dp)&#10;            ) {&#10;                Text(&#10;                    text = title,&#10;                    fontFamily = AppFontFamily,&#10;                    fontWeight = FontWeight.Medium,&#10;                    fontSize = 14.sp,&#10;                    color = Color.Black&#10;                )&#10;                Text(&#10;                    text = time,&#10;                    fontFamily = AppFontFamily,&#10;                    fontSize = 12.sp,&#10;                    color = Color.Gray,&#10;                    modifier = Modifier.padding(top = 4.dp)&#10;                )&#10;            }&#10;&#10;            Button(&#10;                onClick = onSubmit,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = Color(0xFFE0697E)&#10;                ),&#10;                shape = RoundedCornerShape(6.dp),&#10;                modifier = Modifier.height(36.dp)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Submit&quot;,&#10;                    fontFamily = AppFontFamily,&#10;                    color = Color.White,&#10;                    fontSize = 12.sp&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;data class ScheduleItemUI(&#10;    val scheduleId: Int = 0,&#10;    val courseId: Int = 0,&#10;    val title: String,&#10;    val time: String,&#10;    val room: String? = null&#10;)&#10;&#10;data class DayScheduleData(&#10;    val dayName: String,&#10;    val schedules: List&lt;ScheduleItemUI&gt;&#10;)&#10;&#10;// Helper functions for current day&#10;private fun getCurrentDayName(): String {&#10;    val dayOfWeek = java.time.LocalDate.now().dayOfWeek&#10;    return when (dayOfWeek) {&#10;        java.time.DayOfWeek.MONDAY -&gt; &quot;Monday&quot;&#10;        java.time.DayOfWeek.TUESDAY -&gt; &quot;Tuesday&quot;&#10;        java.time.DayOfWeek.WEDNESDAY -&gt; &quot;Wednesday&quot;&#10;        java.time.DayOfWeek.THURSDAY -&gt; &quot;Thursday&quot;&#10;        java.time.DayOfWeek.FRIDAY -&gt; &quot;Friday&quot;&#10;        java.time.DayOfWeek.SATURDAY -&gt; &quot;Monday&quot; // Default to Monday for weekend&#10;        java.time.DayOfWeek.SUNDAY -&gt; &quot;Monday&quot; // Default to Monday for weekend&#10;    }&#10;}&#10;&#10;private fun getCurrentDayIndex(): Int {&#10;    val dayOfWeek = java.time.LocalDate.now().dayOfWeek&#10;    return when (dayOfWeek) {&#10;        java.time.DayOfWeek.MONDAY -&gt; 0&#10;        java.time.DayOfWeek.TUESDAY -&gt; 1&#10;        java.time.DayOfWeek.WEDNESDAY -&gt; 2&#10;        java.time.DayOfWeek.THURSDAY -&gt; 3&#10;        java.time.DayOfWeek.FRIDAY -&gt; 4&#10;        else -&gt; 0 // Default to Monday (index 0) for weekend&#10;    }&#10;}&#10;&#10;@Preview&#10;@Composable&#10;fun ScheduleScreenPreview() {&#10;    ScheduleScreen(&#10;        user = null,&#10;        onNavigateBack = {},&#10;        onNavigate = {},&#10;        onSubmitAttendance = {}&#10;    )&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/database_functions.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/database_functions.sql" />
              <option name="updatedContent" value="-- ==============================&#10;-- STORED PROCEDURES FOR STATISTICS&#10;-- ==============================&#10;&#10;-- Function untuk mendapatkan statistik keseluruhan user&#10;CREATE OR REPLACE FUNCTION get_user_statistics(p_user_id VARCHAR)&#10;RETURNS TABLE(&#10;    total_present BIGINT,&#10;    total_late BIGINT, &#10;    total_absent BIGINT,&#10;    total_meetings BIGINT,&#10;    attendance_percentage NUMERIC&#10;) AS $$&#10;BEGIN&#10;    RETURN QUERY&#10;    SELECT &#10;        COALESCE(SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END), 0) as total_present,&#10;        COALESCE(SUM(CASE WHEN a.status = 'late' THEN 1 ELSE 0 END), 0) as total_late,&#10;        COALESCE(SUM(CASE WHEN a.status = 'absent' THEN 1 ELSE 0 END), 0) as total_absent,&#10;        COALESCE(COUNT(a.attendance_id), 0) as total_meetings,&#10;        COALESCE(&#10;            ROUND(&#10;                SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) * 100.0 / &#10;                NULLIF(COUNT(a.attendance_id), 0), &#10;                2&#10;            ), &#10;            0&#10;        ) as attendance_percentage&#10;    FROM enrollments e&#10;    LEFT JOIN attendances a ON e.enrollment_id = a.enrollment_id&#10;    WHERE e.user_id = p_user_id;&#10;END;&#10;$$ LANGUAGE plpgsql;&#10;&#10;-- Function untuk mendapatkan statistik per mata kuliah&#10;CREATE OR REPLACE FUNCTION get_course_statistics(p_user_id VARCHAR)&#10;RETURNS TABLE(&#10;    course_code VARCHAR,&#10;    course_name VARCHAR,&#10;    total_pertemuan BIGINT,&#10;    hadir BIGINT,&#10;    terlambat BIGINT,&#10;    tidak_hadir BIGINT,&#10;    persentase_kehadiran NUMERIC&#10;) AS $$&#10;BEGIN&#10;    RETURN QUERY&#10;    SELECT &#10;        c.course_code,&#10;        c.course_name,&#10;        COUNT(a.attendance_id) as total_pertemuan,&#10;        SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) as hadir,&#10;        SUM(CASE WHEN a.status = 'late' THEN 1 ELSE 0 END) as terlambat,&#10;        SUM(CASE WHEN a.status = 'absent' THEN 1 ELSE 0 END) as tidak_hadir,&#10;        ROUND(&#10;            SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) * 100.0 / &#10;            NULLIF(COUNT(a.attendance_id), 0), &#10;            2&#10;        ) as persentase_kehadiran&#10;    FROM enrollments e&#10;    JOIN courses c ON e.course_id = c.course_id&#10;    LEFT JOIN attendances a ON e.enrollment_id = a.enrollment_id&#10;    WHERE e.user_id = p_user_id&#10;    GROUP BY c.course_code, c.course_name, c.course_id&#10;    ORDER BY c.course_code;&#10;END;&#10;$$ LANGUAGE plpgsql;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>