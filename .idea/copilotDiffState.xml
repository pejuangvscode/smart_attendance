<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/SubmissionScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/SubmissionScreen.kt" />
              <option name="originalContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AttendanceApi&#10;import com.example.smartattendance.api.AuthApi&#10;import kotlinx.coroutines.launch&#10;import androidx.navigation.NavController&#10;&#10;@Composable&#10;fun SubmissionScreen(&#10;    modifier: Modifier = Modifier,&#10;    user: AuthApi.User?,&#10;    navController: NavController,&#10;    scheduleId: Int?,&#10;    courseId: Int?,&#10;    onAttendanceSubmitted: () -&gt; Unit = {}&#10;) {&#10;    val scope = rememberCoroutineScope()&#10;    var isSubmitting by remember { mutableStateOf(false) }&#10;    var message by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // Validasi Supabase&#10;    val supabaseClient = AuthApi.supabase&#10;    val attendanceApi = supabaseClient?.let { AttendanceApi(it) }&#10;    var attendanceChecked by remember { mutableStateOf(false) }&#10;    var alreadyHasRow by remember { mutableStateOf(false) }&#10;    var attendanceStatus by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // Ambil detail kelas&#10;    var courseName by remember { mutableStateOf(&quot;&quot;) }&#10;    var scheduleInfo by remember { mutableStateOf(&quot;&quot;) }&#10;    var roomInfo by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    val userId = user?.user_id ?: &quot;&quot;&#10;    val isReady = userId.isNotEmpty() &amp;&amp; scheduleId != null &amp;&amp; courseId != null &amp;&amp; attendanceApi != null&#10;&#10;    LaunchedEffect(courseId) {&#10;        if (courseId != null &amp;&amp; attendanceApi != null) {&#10;            courseName = attendanceApi.getCourseName(courseId) ?: &quot;Unknown Course&quot;&#10;        }&#10;    }&#10;    LaunchedEffect(scheduleId) {&#10;        if (scheduleId != null &amp;&amp; attendanceApi != null) {&#10;            val info = attendanceApi.getScheduleInfo(scheduleId)&#10;            if (info != null) {&#10;                scheduleInfo = &quot;${info.day} ${info.start_time} - ${info.end_time}&quot;&#10;                roomInfo = info.room ?: &quot;-&quot;&#10;            }&#10;        }&#10;    }&#10;&#10;    // Check today's attendance before showing submit button&#10;    LaunchedEffect(userId, scheduleId, courseId) {&#10;        if (isReady &amp;&amp; !attendanceChecked) {&#10;            val record = attendanceApi?.getTodayAttendance(userId, scheduleId!!, courseId!!)?.getOrNull()&#10;            attendanceChecked = true&#10;            if (record != null) {&#10;                alreadyHasRow = true&#10;                attendanceStatus = record.status&#10;                // Jika sudah ada row dan status pending serta is_verified false, langsung redirect&#10;                if (record.status == &quot;pending&quot; &amp;&amp; !record.is_verified) {&#10;                    val encodedCourseName = java.net.URLEncoder.encode(courseName, &quot;UTF-8&quot;)&#10;                    navController.navigate(&quot;submission_complete_screen/pending/${encodedCourseName}/${courseId}/${scheduleId}&quot;)&#10;                }&#10;                // Jika sudah ada row, tampilkan peringatan&#10;            }&#10;        }&#10;    }&#10;&#10;    Column(&#10;        modifier = modifier.fillMaxSize().padding(24.dp),&#10;        verticalArrangement = Arrangement.Top,&#10;        horizontalAlignment = Alignment.Start&#10;    ) {&#10;        Text(&quot;Informasi Kelas&quot;, fontSize = 20.sp, fontWeight = FontWeight.Bold)&#10;        Spacer(modifier = Modifier.height(8.dp))&#10;        Text(&quot;Mata Kuliah: $courseName&quot;, fontSize = 16.sp)&#10;        Text(&quot;Jadwal: $scheduleInfo&quot;, fontSize = 16.sp)&#10;        Text(&quot;Ruangan: $roomInfo&quot;, fontSize = 16.sp)&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        Divider()&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        Text(&quot;Status Kehadiran: ${if (!alreadyHasRow) &quot;Belum absen&quot; else attendanceStatus}&quot;, fontSize = 16.sp, fontWeight = FontWeight.Medium)&#10;        if (alreadyHasRow) {&#10;            Spacer(modifier = Modifier.height(12.dp))&#10;            Text(&quot;Segera masuk kelas agar wajah tertangkap kamera untuk absen dan akhirnya verified.&quot;, color = MaterialTheme.colorScheme.error, fontSize = 14.sp)&#10;        }&#10;        Spacer(modifier = Modifier.height(24.dp))&#10;        if (!isReady) {&#10;            Text(&quot;Error: Data tidak lengkap atau Supabase belum siap.\nuserId: $userId\nscheduleId: $scheduleId\ncourseId: $courseId\nSupabase: ${if (attendanceApi == null) &quot;null&quot; else &quot;ready&quot;}&quot;, color = MaterialTheme.colorScheme.error)&#10;        }&#10;        if (!alreadyHasRow) {&#10;            Button(&#10;                onClick = {&#10;                    if (isReady) {&#10;                        isSubmitting = true&#10;                        scope.launch {&#10;                            try {&#10;                                val result = attendanceApi.submitAttendance(userId, scheduleId, courseId)&#10;                                if (result.isSuccess) {&#10;                                    val status = result.getOrNull()?.second ?: &quot;pending&quot;&#10;                                    val encodedCourseName = java.net.URLEncoder.encode(courseName, &quot;UTF-8&quot;)&#10;                                    navController.navigate(&quot;submission_complete_screen/${status}/${encodedCourseName}/${courseId}/${scheduleId}&quot;)&#10;                                } else {&#10;                                    message = &quot;Gagal mencatat kehadiran: ${result.exceptionOrNull()?.message ?: &quot;Unknown error&quot;}&quot;&#10;                                }&#10;                            } catch (e: Exception) {&#10;                                message = &quot;Gagal submit: ${e.message ?: e.toString()}&quot;&#10;                            } finally {&#10;                                isSubmitting = false&#10;                                onAttendanceSubmitted()&#10;                            }&#10;                        }&#10;                    } else {&#10;                        message = &quot;User ID, schedule, course, atau Supabase tidak valid.&quot;&#10;                    }&#10;                },&#10;                enabled = !isSubmitting &amp;&amp; isReady&#10;            ) {&#10;                Text(if (isSubmitting) &quot;Submitting...&quot; else &quot;Submit Attendance&quot;)&#10;            }&#10;        }&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        if (message.isNotEmpty()) {&#10;            Text(message, color = if (message.startsWith(&quot;Gagal&quot;) || message.startsWith(&quot;Error&quot;)) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onBackground)&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AttendanceApi&#10;import com.example.smartattendance.api.AuthApi&#10;import kotlinx.coroutines.launch&#10;import androidx.navigation.NavController&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.CheckCircle&#10;import androidx.compose.material.icons.filled.Schedule&#10;import androidx.compose.material.icons.filled.Error&#10;&#10;@Composable&#10;fun SubmissionScreen(&#10;    modifier: Modifier = Modifier,&#10;    user: AuthApi.User?,&#10;    navController: NavController,&#10;    scheduleId: Int?,&#10;    courseId: Int?,&#10;    onAttendanceSubmitted: () -&gt; Unit = {}&#10;) {&#10;    val scope = rememberCoroutineScope()&#10;    var isSubmitting by remember { mutableStateOf(false) }&#10;    var message by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // Validasi Supabase&#10;    val supabaseClient = AuthApi.supabase&#10;    val attendanceApi = supabaseClient?.let { AttendanceApi(it) }&#10;    var attendanceChecked by remember { mutableStateOf(false) }&#10;    var alreadyHasRow by remember { mutableStateOf(false) }&#10;    var attendanceStatus by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    // Ambil detail kelas&#10;    var courseName by remember { mutableStateOf(&quot;&quot;) }&#10;    var scheduleInfo by remember { mutableStateOf(&quot;&quot;) }&#10;    var roomInfo by remember { mutableStateOf(&quot;&quot;) }&#10;&#10;    val userId = user?.user_id ?: &quot;&quot;&#10;    val isReady = userId.isNotEmpty() &amp;&amp; scheduleId != null &amp;&amp; courseId != null &amp;&amp; attendanceApi != null&#10;&#10;    LaunchedEffect(courseId) {&#10;        if (courseId != null &amp;&amp; attendanceApi != null) {&#10;            courseName = attendanceApi.getCourseName(courseId) ?: &quot;Unknown Course&quot;&#10;        }&#10;    }&#10;    LaunchedEffect(scheduleId) {&#10;        if (scheduleId != null &amp;&amp; attendanceApi != null) {&#10;            val info = attendanceApi.getScheduleInfo(scheduleId)&#10;            if (info != null) {&#10;                scheduleInfo = &quot;${info.day} ${info.start_time} - ${info.end_time}&quot;&#10;                roomInfo = info.room ?: &quot;-&quot;&#10;            }&#10;        }&#10;    }&#10;&#10;    // Check today's attendance before showing submit button&#10;    LaunchedEffect(userId, scheduleId, courseId) {&#10;        if (isReady &amp;&amp; !attendanceChecked) {&#10;            val record = attendanceApi?.getTodayAttendance(userId, scheduleId!!, courseId!!)?.getOrNull()&#10;            attendanceChecked = true&#10;            if (record != null) {&#10;                alreadyHasRow = true&#10;                attendanceStatus = record.status&#10;                // Jika sudah ada row dan status pending serta is_verified false, langsung redirect&#10;                if (record.status == &quot;pending&quot; &amp;&amp; !record.is_verified) {&#10;                    val encodedCourseName = java.net.URLEncoder.encode(courseName, &quot;UTF-8&quot;)&#10;                    navController.navigate(&quot;submission_complete_screen/pending/${encodedCourseName}/${courseId}/${scheduleId}&quot;)&#10;                }&#10;                // Jika sudah ada row dan is_verified true dan status bukan pending, langsung ke submission complete dengan logo CheckCircle&#10;                if (record.is_verified &amp;&amp; record.status != &quot;pending&quot;) {&#10;                    val encodedCourseName = java.net.URLEncoder.encode(courseName, &quot;UTF-8&quot;)&#10;                    navController.navigate(&quot;submission_complete_screen/${record.status}/${encodedCourseName}/${courseId}/${scheduleId}&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    Column(&#10;        modifier = modifier.fillMaxSize().padding(24.dp),&#10;        verticalArrangement = Arrangement.Top,&#10;        horizontalAlignment = Alignment.Start&#10;    ) {&#10;        Text(&quot;Informasi Kelas&quot;, fontSize = 20.sp, fontWeight = FontWeight.Bold)&#10;        Spacer(modifier = Modifier.height(8.dp))&#10;        Text(&quot;Mata Kuliah: $courseName&quot;, fontSize = 16.sp)&#10;        Text(&quot;Jadwal: $scheduleInfo&quot;, fontSize = 16.sp)&#10;        Text(&quot;Ruangan: $roomInfo&quot;, fontSize = 16.sp)&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        Divider()&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        Text(&quot;Status Kehadiran: ${if (!alreadyHasRow) &quot;Belum absen&quot; else attendanceStatus}&quot;, fontSize = 16.sp, fontWeight = FontWeight.Medium)&#10;        if (alreadyHasRow) {&#10;            Spacer(modifier = Modifier.height(12.dp))&#10;            Text(&quot;Segera masuk kelas agar wajah tertangkap kamera untuk absen dan akhirnya verified.&quot;, color = MaterialTheme.colorScheme.error, fontSize = 14.sp)&#10;        }&#10;        Spacer(modifier = Modifier.height(24.dp))&#10;        if (!isReady) {&#10;            Text(&quot;Error: Data tidak lengkap atau Supabase belum siap.\nuserId: $userId\nscheduleId: $scheduleId\ncourseId: $courseId\nSupabase: ${if (attendanceApi == null) &quot;null&quot; else &quot;ready&quot;}&quot;, color = MaterialTheme.colorScheme.error)&#10;        }&#10;        if (!alreadyHasRow) {&#10;            Button(&#10;                onClick = {&#10;                    if (isReady) {&#10;                        isSubmitting = true&#10;                        scope.launch {&#10;                            try {&#10;                                val result = attendanceApi.submitAttendance(userId, scheduleId, courseId)&#10;                                if (result.isSuccess) {&#10;                                    val status = result.getOrNull()?.second ?: &quot;pending&quot;&#10;                                    val encodedCourseName = java.net.URLEncoder.encode(courseName, &quot;UTF-8&quot;)&#10;                                    navController.navigate(&quot;submission_complete_screen/${status}/${encodedCourseName}/${courseId}/${scheduleId}&quot;)&#10;                                } else {&#10;                                    message = &quot;Gagal mencatat kehadiran: ${result.exceptionOrNull()?.message ?: &quot;Unknown error&quot;}&quot;&#10;                                }&#10;                            } catch (e: Exception) {&#10;                                message = &quot;Gagal submit: ${e.message ?: e.toString()}&quot;&#10;                            } finally {&#10;                                isSubmitting = false&#10;                                onAttendanceSubmitted()&#10;                            }&#10;                        }&#10;                    } else {&#10;                        message = &quot;User ID, schedule, course, atau Supabase tidak valid.&quot;&#10;                    }&#10;                },&#10;                enabled = !isSubmitting &amp;&amp; isReady&#10;            ) {&#10;                Text(if (isSubmitting) &quot;Submitting...&quot; else &quot;Submit Attendance&quot;)&#10;            }&#10;        }&#10;        Spacer(modifier = Modifier.height(16.dp))&#10;        if (message.isNotEmpty()) {&#10;            Text(message, color = if (message.startsWith(&quot;Gagal&quot;) || message.startsWith(&quot;Error&quot;)) MaterialTheme.colorScheme.error else MaterialTheme.colorScheme.onBackground)&#10;        }&#10;        if (alreadyHasRow &amp;&amp; attendanceStatus != &quot;pending&quot;) {&#10;            Row(verticalAlignment = Alignment.CenterVertically) {&#10;                val icon = when (attendanceStatus) {&#10;                    &quot;present&quot; -&gt; Icons.Filled.CheckCircle&#10;                    &quot;late&quot; -&gt; Icons.Filled.Schedule&#10;                    &quot;absent&quot; -&gt; Icons.Filled.Error&#10;                    else -&gt; Icons.Filled.Error&#10;                }&#10;                Icon(icon, contentDescription = attendanceStatus.capitalize(), tint = MaterialTheme.colorScheme.primary)&#10;                Spacer(modifier = Modifier.width(8.dp))&#10;                Text(&quot;Status: ${attendanceStatus.capitalize()}&quot;, fontSize = 16.sp, fontWeight = FontWeight.Medium)&#10;            }&#10;        }&#10;        if (alreadyHasRow &amp;&amp; attendanceStatus == &quot;pending&quot;) {&#10;            Spacer(modifier = Modifier.height(12.dp))&#10;            // Tidak perlu warning lagi jika status sudah present&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/SubmitionComplete.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/smartattendance/ui/screens/SubmitionComplete.kt" />
              <option name="originalContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.CheckCircle&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AttendanceDetailApi&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.api.AttendanceDetailData&#10;import com.example.smartattendance.ui.components.AppHeader&#10;import com.example.smartattendance.ui.components.HeaderType&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.theme.AppFontFamily&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SubmitionComplete(&#10;    status: String = &quot;pending&quot;,&#10;    courseName: String = &quot;&quot;,&#10;    courseId: Int = 0,&#10;    scheduleId: Int = 0,&#10;    onBackClick: () -&gt; Unit = {},&#10;    onNavigateHome: () -&gt; Unit = {}&#10;) {&#10;    var detail by remember { mutableStateOf&lt;AttendanceDetailData?&gt;(null) }&#10;    val supabaseClient = AuthApi.supabase&#10;&#10;    LaunchedEffect(courseId, scheduleId) {&#10;        if (supabaseClient != null &amp;&amp; courseId != 0 &amp;&amp; scheduleId != 0) {&#10;            detail = AttendanceDetailApi.getAttendanceDetail(supabaseClient, courseId, scheduleId)&#10;        }&#10;    }&#10;&#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(Color.White)&#10;    ) {&#10;        // Header&#10;        AppHeader(&#10;            title = &quot;Attendance Detail&quot;,&#10;            headerType = HeaderType.BACK,&#10;            onBackClick = onBackClick&#10;        )&#10;&#10;        // Content&#10;        Column(&#10;            modifier = Modifier&#10;                .weight(1f)&#10;                .fillMaxWidth()&#10;                .background(Color(0xFFF6F6F6))&#10;                .padding(start = 28.dp, end = 28.dp)&#10;                .verticalScroll(rememberScrollState()),&#10;            horizontalAlignment = Alignment.CenterHorizontally,&#10;        ) {&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            // Pending Icon&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(120.dp)&#10;                    .background(&#10;                        color = Color(0xFFFFD54F),&#10;                        shape = RoundedCornerShape(60.dp)&#10;                    ),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Row(&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                ) {&#10;                    repeat(3) {&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .size(12.dp)&#10;                                .background(&#10;                                    color = Color.White,&#10;                                    shape = RoundedCornerShape(6.dp)&#10;                                )&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            Text(&#10;                text = status.uppercase(),&#10;                fontSize = 32.sp,&#10;                fontWeight = FontWeight.Bold,&#10;                fontFamily = AppFontFamily,&#10;                color = Color(0xFFFFD54F),&#10;                letterSpacing = 2.sp&#10;            )&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Warning Card&#10;            Card(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                shape = RoundedCornerShape(8.dp)&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Warning!&quot;,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontFamily = AppFontFamily,&#10;                        color = Color.Red,&#10;                        modifier = Modifier.fillMaxWidth()&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Text(&#10;                        text = &quot;Ensure your face is visible to the external camera so that your presence can be verified.&quot;,&#10;                        fontSize = 14.sp,&#10;                        fontFamily = AppFontFamily,&#10;                        color = Color(0xFF666666),&#10;                        lineHeight = 20.sp&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Detail Card&#10;            Card(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                shape = RoundedCornerShape(8.dp)&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Detail&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontFamily = AppFontFamily,&#10;                        color = Color(0xFF2C2D32)&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    // Detail Items&#10;                    DetailRow(&quot;Class&quot;, detail?.courseName ?: courseName)&#10;                    DetailRow(&quot;Instructor&quot;, detail?.instructorName ?: &quot;&quot;)&#10;                    DetailRow(&quot;Room&quot;, detail?.room ?: &quot;&quot;)&#10;                    DetailRow(&quot;Date&quot;, detail?.attendanceDate ?: &quot;&quot;)&#10;                    DetailRow(&quot;Time&quot;, detail?.attendanceTime ?: &quot;&quot;)&#10;                    DetailRow(&quot;Status&quot;, status.uppercase(), statusColor = Color(0xFFFFD54F))&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Class Information Card&#10;            Card(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(bottom = 20.dp),&#10;                colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                shape = RoundedCornerShape(8.dp),&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Class Information&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontFamily = AppFontFamily,&#10;                        fontWeight = FontWeight.Bold,&#10;                        color = Color(0xFF2C2D32)&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    DetailRow(&quot;Instructor&quot;, detail?.instructorName ?: &quot;&quot;)&#10;                    DetailRow(&quot;Room&quot;, detail?.room ?: &quot;&quot;)&#10;                    DetailRow(&quot;Day&quot;, detail?.day ?: &quot;&quot;)&#10;                    DetailRow(&quot;Schedule&quot;, &quot;${detail?.startTime ?: &quot;&quot;} - ${detail?.endTime ?: &quot;&quot;}&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun DetailRow(&#10;    label: String,&#10;    value: String,&#10;    statusColor: Color? = null&#10;) {&#10;    Row(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(vertical = 8.dp),&#10;        horizontalArrangement = Arrangement.SpaceBetween,&#10;        verticalAlignment = Alignment.Top&#10;    ) {&#10;        Text(&#10;            text = label,&#10;            fontSize = 14.sp,&#10;            color = Color(0xFF666666),&#10;            modifier = Modifier.weight(1f),&#10;            fontFamily = AppFontFamily&#10;        )&#10;&#10;        Text(&#10;            text = value,&#10;            fontSize = 14.sp,&#10;            color = statusColor ?: Color(0xFF2C2D32),&#10;            fontWeight = if (statusColor != null) FontWeight.Bold else FontWeight.Normal,&#10;            textAlign = TextAlign.End,&#10;            modifier = Modifier.weight(1f),&#10;            fontFamily = AppFontFamily&#10;        )&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun SubmitionCompletePreview() {&#10;    SubmitionComplete()&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.smartattendance.ui.screens&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.AccessTimeFilled&#10;import androidx.compose.material.icons.filled.AddCircle&#10;import androidx.compose.material.icons.filled.Cancel&#10;import androidx.compose.material.icons.filled.CheckCircle&#10;import androidx.compose.material.icons.filled.Error&#10;import androidx.compose.material.icons.filled.HdrAuto&#10;import androidx.compose.material.icons.filled.Info&#10;import androidx.compose.material.icons.filled.Outbound&#10;import androidx.compose.material.icons.filled.Pending&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.smartattendance.api.AttendanceDetailApi&#10;import com.example.smartattendance.api.AuthApi&#10;import com.example.smartattendance.api.AttendanceDetailData&#10;import com.example.smartattendance.ui.components.AppHeader&#10;import com.example.smartattendance.ui.components.HeaderType&#10;import com.example.smartattendance.ui.components.AppBottomNavigation&#10;import com.example.smartattendance.ui.theme.AppFontFamily&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SubmitionComplete(&#10;    status: String = &quot;pending&quot;,&#10;    courseName: String = &quot;&quot;,&#10;    courseId: Int = 0,&#10;    scheduleId: Int = 0,&#10;    onBackClick: () -&gt; Unit = {},&#10;    onNavigateHome: () -&gt; Unit = {}&#10;) {&#10;    var detail by remember { mutableStateOf&lt;AttendanceDetailData?&gt;(null) }&#10;    val supabaseClient = AuthApi.supabase&#10;&#10;    LaunchedEffect(courseId, scheduleId) {&#10;        if (supabaseClient != null &amp;&amp; courseId != 0 &amp;&amp; scheduleId != 0) {&#10;            detail = AttendanceDetailApi.getAttendanceDetail(supabaseClient, courseId, scheduleId)&#10;        }&#10;    }&#10;&#10;    Column(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(Color.White)&#10;    ) {&#10;        // Header&#10;        AppHeader(&#10;            title = &quot;Attendance Detail&quot;,&#10;            headerType = HeaderType.BACK,&#10;            onBackClick = {&#10;                try {&#10;                    onNavigateHome()&#10;                } catch (e: Exception) {&#10;                    // Fallback: do nothing or show error&#10;                }&#10;            }&#10;        )&#10;&#10;        // Content&#10;        Column(&#10;            modifier = Modifier&#10;                .weight(1f)&#10;                .fillMaxWidth()&#10;                .background(Color(0xFFF6F6F6))&#10;                .padding(start = 28.dp, end = 28.dp)&#10;                .verticalScroll(rememberScrollState()),&#10;            horizontalAlignment = Alignment.CenterHorizontally,&#10;        ) {&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            // Status Icon &amp; Color Mapping&#10;            val (statusColor, statusIcon) = when (status.lowercase()) {&#10;                &quot;present&quot; -&gt; Color(0xFF00CC2C) to Icons.Filled.CheckCircle&#10;                &quot;absent&quot; -&gt; Color(0xFFE53E3E) to Icons.Filled.HdrAuto&#10;                &quot;late&quot; -&gt; Color(0xFFFF9D00) to Icons.Filled.AccessTimeFilled&#10;                &quot;pending&quot; -&gt; Color(0xFFFF9D00) to Icons.Filled.Pending&#10;                &quot;approved&quot; -&gt; Color(0xFF4285F4) to Icons.Filled.CheckCircle&#10;                &quot;rejected&quot; -&gt; Color(0xFFE53E3E) to Icons.Filled.Cancel&#10;                &quot;not yet&quot; -&gt; Color(0xFF2C2D32) to Icons.Filled.Info&#10;                &quot;sick&quot; -&gt; Color(0xFF9C27B0) to Icons.Filled.AddCircle&#10;                &quot;excused&quot; -&gt; Color(0xFF607D8B) to Icons.Filled.Outbound&#10;                else -&gt; Color(0xFF00CC2C) to Icons.Filled.CheckCircle&#10;            }&#10;            Box(&#10;                modifier = Modifier.size(120.dp),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Icon(&#10;                    statusIcon,&#10;                    contentDescription = status.capitalize(),&#10;                    tint = statusColor,&#10;                    modifier = Modifier.size(96.dp)&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            // Status Text&#10;            Text(&#10;                text = status.uppercase(),&#10;                fontSize = 32.sp,&#10;                fontWeight = FontWeight.Bold,&#10;                fontFamily = AppFontFamily,&#10;                color = statusColor,&#10;                letterSpacing = 2.sp&#10;            )&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Warning Card only for pending&#10;            if (status.lowercase() == &quot;pending&quot;) {&#10;                Card(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                    elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                    shape = RoundedCornerShape(8.dp)&#10;                ) {&#10;                    Column(&#10;                        modifier = Modifier.padding(16.dp)&#10;                    ) {&#10;                        Text(&#10;                            text = &quot;Warning!&quot;,&#10;                            fontSize = 16.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            fontFamily = AppFontFamily,&#10;                            color = Color.Red,&#10;                            modifier = Modifier.fillMaxWidth()&#10;                        )&#10;&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                        Text(&#10;                            text = &quot;Ensure your face is visible to the external camera so that your presence can be verified.&quot;,&#10;                            fontSize = 14.sp,&#10;                            fontFamily = AppFontFamily,&#10;                            color = Color(0xFF666666),&#10;                            lineHeight = 20.sp&#10;                        )&#10;                    }&#10;                }&#10;&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;            }&#10;&#10;            // Detail Card&#10;            Card(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                shape = RoundedCornerShape(8.dp)&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Detail&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontFamily = AppFontFamily,&#10;                        color = Color(0xFF2C2D32)&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    // Detail Items&#10;                    DetailRow(&quot;Class&quot;, detail?.courseName ?: courseName)&#10;                    DetailRow(&quot;Instructor&quot;, detail?.instructorName ?: &quot;&quot;)&#10;                    DetailRow(&quot;Room&quot;, detail?.room ?: &quot;&quot;)&#10;                    DetailRow(&quot;Date&quot;, detail?.attendanceDate ?: &quot;&quot;)&#10;                    DetailRow(&quot;Time&quot;, detail?.attendanceTime ?: &quot;&quot;)&#10;                    DetailRow(&quot;Status&quot;, status.uppercase(), statusColor = statusColor)&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Class Information Card&#10;            Card(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(bottom = 20.dp),&#10;                colors = CardDefaults.cardColors(containerColor = Color.White),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp),&#10;                shape = RoundedCornerShape(8.dp),&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier.padding(16.dp)&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Class Information&quot;,&#10;                        fontSize = 18.sp,&#10;                        fontFamily = AppFontFamily,&#10;                        fontWeight = FontWeight.Bold,&#10;                        color = Color(0xFF2C2D32)&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    DetailRow(&quot;Instructor&quot;, detail?.instructorName ?: &quot;&quot;)&#10;                    DetailRow(&quot;Room&quot;, detail?.room ?: &quot;&quot;)&#10;                    DetailRow(&quot;Day&quot;, detail?.day ?: &quot;&quot;)&#10;                    DetailRow(&quot;Schedule&quot;, &quot;${detail?.startTime ?: &quot;&quot;} - ${detail?.endTime ?: &quot;&quot;}&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun DetailRow(&#10;    label: String,&#10;    value: String,&#10;    statusColor: Color? = null&#10;) {&#10;    Row(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .padding(vertical = 8.dp),&#10;        horizontalArrangement = Arrangement.SpaceBetween,&#10;        verticalAlignment = Alignment.Top&#10;    ) {&#10;        Text(&#10;            text = label,&#10;            fontSize = 14.sp,&#10;            color = Color(0xFF666666),&#10;            modifier = Modifier.weight(1f),&#10;            fontFamily = AppFontFamily&#10;        )&#10;&#10;        Text(&#10;            text = value,&#10;            fontSize = 14.sp,&#10;            color = statusColor ?: Color(0xFF2C2D32),&#10;            fontWeight = if (statusColor != null) FontWeight.Bold else FontWeight.Normal,&#10;            textAlign = TextAlign.End,&#10;            modifier = Modifier.weight(1f),&#10;            fontFamily = AppFontFamily&#10;        )&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun SubmitionCompletePreview() {&#10;    SubmitionComplete()&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/database_functions.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/database_functions.sql" />
              <option name="updatedContent" value="-- ==============================&#10;-- STORED PROCEDURES FOR STATISTICS&#10;-- ==============================&#10;&#10;-- Function untuk mendapatkan statistik keseluruhan user&#10;CREATE OR REPLACE FUNCTION get_user_statistics(p_user_id VARCHAR)&#10;RETURNS TABLE(&#10;    total_present BIGINT,&#10;    total_late BIGINT, &#10;    total_absent BIGINT,&#10;    total_meetings BIGINT,&#10;    attendance_percentage NUMERIC&#10;) AS $$&#10;BEGIN&#10;    RETURN QUERY&#10;    SELECT &#10;        COALESCE(SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END), 0) as total_present,&#10;        COALESCE(SUM(CASE WHEN a.status = 'late' THEN 1 ELSE 0 END), 0) as total_late,&#10;        COALESCE(SUM(CASE WHEN a.status = 'absent' THEN 1 ELSE 0 END), 0) as total_absent,&#10;        COALESCE(COUNT(a.attendance_id), 0) as total_meetings,&#10;        COALESCE(&#10;            ROUND(&#10;                SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) * 100.0 / &#10;                NULLIF(COUNT(a.attendance_id), 0), &#10;                2&#10;            ), &#10;            0&#10;        ) as attendance_percentage&#10;    FROM enrollments e&#10;    LEFT JOIN attendances a ON e.enrollment_id = a.enrollment_id&#10;    WHERE e.user_id = p_user_id;&#10;END;&#10;$$ LANGUAGE plpgsql;&#10;&#10;-- Function untuk mendapatkan statistik per mata kuliah&#10;CREATE OR REPLACE FUNCTION get_course_statistics(p_user_id VARCHAR)&#10;RETURNS TABLE(&#10;    course_code VARCHAR,&#10;    course_name VARCHAR,&#10;    total_pertemuan BIGINT,&#10;    hadir BIGINT,&#10;    terlambat BIGINT,&#10;    tidak_hadir BIGINT,&#10;    persentase_kehadiran NUMERIC&#10;) AS $$&#10;BEGIN&#10;    RETURN QUERY&#10;    SELECT &#10;        c.course_code,&#10;        c.course_name,&#10;        COUNT(a.attendance_id) as total_pertemuan,&#10;        SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) as hadir,&#10;        SUM(CASE WHEN a.status = 'late' THEN 1 ELSE 0 END) as terlambat,&#10;        SUM(CASE WHEN a.status = 'absent' THEN 1 ELSE 0 END) as tidak_hadir,&#10;        ROUND(&#10;            SUM(CASE WHEN a.status = 'present' THEN 1 ELSE 0 END) * 100.0 / &#10;            NULLIF(COUNT(a.attendance_id), 0), &#10;            2&#10;        ) as persentase_kehadiran&#10;    FROM enrollments e&#10;    JOIN courses c ON e.course_id = c.course_id&#10;    LEFT JOIN attendances a ON e.enrollment_id = a.enrollment_id&#10;    WHERE e.user_id = p_user_id&#10;    GROUP BY c.course_code, c.course_name, c.course_id&#10;    ORDER BY c.course_code;&#10;END;&#10;$$ LANGUAGE plpgsql;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>